var y=Object.defineProperty;var N=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var v=(i,l,e)=>l in i?y(i,l,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[l]=e,u=(i,l)=>{for(var e in l||(l={}))$.call(l,e)&&v(i,e,l[e]);if(N)for(var e of N(l))M.call(l,e)&&v(i,e,l[e]);return i};import{d as L,j as s,L as q}from"./main-149.js";import{c as _,_ as n,m as R,n as T,o as V,T as O,p as k,r as D}from"./bi.738.82.js";import{T as I}from"./bi.653.689.js";const E=(i,l,e,t,d)=>{t(!0),_({},"refresh_news_letter").then(r=>{if(r&&r.success){const c=u({},l);c.default||(c.default={}),r.data.newsletterList&&(c.default.newsletterList=r.data.newsletterList),d({show:!0,msg:n("Newsletter list refreshed","bit-integrations")}),e(u({},c))}else r&&r.data&&r.data.data||!r.success&&typeof r.data=="string"?d({show:!0,msg:`${n("Newsletter list refresh failed Cause:","bit-integrations")}${r.data.data||r.data}. ${n("please try again","bit-integrations")}`}):d({show:!0,msg:n("Newsletter list refresh failed. please try again","bit-integrations")});t(!1)}).catch(()=>t(!1))},G=(i,l,e,t)=>{_({},"mail_poet_list_headers").then(d=>{if(d&&d.success){const r=u({},i);if(d.data.mailPoetFields){r.default.fields=d.data.mailPoetFields;const{fields:c}=r.default;r.field_map=Object.values(c).filter(m=>m.required).map(m=>({formField:"",mailPoetField:m.id,required:!0})),t({show:!0,msg:n("Mailpoet fields refreshed","bit-integrations")})}else t({show:!0,msg:n("No Mailpoet fields found. Try changing the header row number or try again","bit-integrations")});d.data.tokenDetails&&(r.tokenDetails=d.data.tokenDetails),l(u({},r))}else t({show:!0,msg:n("Mailpoet fields refresh failed. please try again","bit-integrations")});e(!1)}).catch(()=>e(!1))},K=(i,l,e)=>{const t=u({},l);t.name=i.target.value,e(u({},t))},Q=i=>!((i!=null&&i.field_map?i.field_map.filter(e=>!e.formField&&e.mailPoetField&&e.required):[]).length>0);function H({i,formFields:l,field:e,mailPoetConf:t,setMailPoetConf:d}){var o,w,f,F;const r=e.required,c=((o=t==null?void 0:t.default)==null?void 0:o.fields)&&Object.values((w=t==null?void 0:t.default)==null?void 0:w.fields).filter(a=>a.required===""),m=L(R),{isPro:x}=m,p=a=>{const b=u({},t);b.field_map.splice(a,0,{}),d(b)},h=a=>{const b=u({},t);b.field_map.length>1&&b.field_map.splice(a,1),d(b)},j=(a,b)=>{const g=u({},t);g.field_map[b][a.target.name]=a.target.value,a.target.value==="custom"&&(g.field_map[b].customValue=""),d(g)};return s.jsxs("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:[s.jsxs("div",{className:"flx integ-fld-wrp",children:[s.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:e.formField||"",onChange:a=>j(a,i),children:[s.jsx("option",{value:"",children:n("Select Field","bit-integrations")}),s.jsx("optgroup",{label:"Form Fields",children:l==null?void 0:l.map(a=>s.jsx("option",{value:a.name,children:a.label},`ff-rm-${a.name}`))}),s.jsx("option",{value:"custom",children:n("Custom...","bit-integrations")}),s.jsx("optgroup",{label:`General Smart Codes ${x?"":"(PRO)"}`,children:x&&((f=T)==null?void 0:f.map(a=>s.jsx("option",{value:a.name,children:a.label},`ff-rm-${a.name}`)))})]}),e.formField==="custom"&&s.jsx(I,{onChange:a=>V(a,i,t,d),label:n("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:e.customValue,placeholder:n("Custom Value","bit-integrations"),formFields:l}),s.jsxs("select",{className:"btcd-paper-inp",name:"mailPoetField",value:e.mailPoetField,onChange:a=>j(a,i),disabled:r,children:[s.jsx("option",{value:"",children:n("Select Field","bit-integrations")}),r?((F=t==null?void 0:t.default)==null?void 0:F.fields)&&Object.values(t.default.fields).map(a=>s.jsx("option",{value:a.id,children:a.name},`${a.id}-1`)):c&&c.map(a=>s.jsx("option",{value:a.id,children:a.name},`${a.id}-1`))]})]}),!r&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>p(i),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),s.jsx("button",{onClick:()=>h(i),className:"icn-btn sh-sm ml-2",type:"button","aria-label":"btn",children:s.jsx(O,{})})]})]})}function U({formID:i,formFields:l,mailPoetConf:e,setMailPoetConf:t,isLoading:d,setIsLoading:r,setSnackbar:c}){var x;const m=p=>{const h=u({},e);p?(h.lists=p?p.split(","):[],G(h,t,r,c)):delete h.lists,t(u({},h))};return s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsxs("div",{className:"flx",children:[s.jsx("b",{className:"wdt-200 d-in-b",children:n("List: ","bit-integrations")}),s.jsx(k,{defaultValue:e==null?void 0:e.lists,className:"btcd-paper-drpdwn w-6",options:((x=e==null?void 0:e.default)==null?void 0:x.newsletterList)&&Object.keys(e.default.newsletterList).map(p=>({label:e.default.newsletterList[p].newsletterName,value:e.default.newsletterList[p].newsletterId})),onChange:p=>m(p)}),s.jsx("button",{onClick:()=>E(i,e,t,r,c),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${n("Refresh MailPoet List","bit-integrations")}'`},type:"button",disabled:d,children:"â†»"})]}),d&&s.jsx(q,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),(e==null?void 0:e.lists)&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mt-4",children:s.jsx("b",{className:"wdt-100",children:n("Map Fields","bit-integrations")})}),s.jsx("div",{className:"btcd-hr mt-1"}),s.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:n("Form Fields","bit-integrations")})}),s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:n("MailPoet Fields","bit-integrations")})})]}),e.field_map.map((p,h)=>s.jsx(H,{i:h,field:p,mailPoetConf:e,formFields:l,setMailPoetConf:t},`mailpoet-m-${h+9}`)),s.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:s.jsx("button",{onClick:()=>D(e.field_map.length,e,t),className:"icn-btn sh-sm",type:"button",children:"+"})}),s.jsx("br",{}),s.jsx("br",{})]})]})}export{U as M,Q as c,K as h,E as r};
