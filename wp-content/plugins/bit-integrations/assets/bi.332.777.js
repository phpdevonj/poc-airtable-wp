var K=Object.defineProperty;var R=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var E=(a,i,t)=>i in a?K(a,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[i]=t,p=(a,i)=>{for(var t in i||(i={}))Q.call(i,t)&&E(a,t,i[t]);if(R)for(var t of R(i))X.call(i,t)&&E(a,t,i[t]);return a};import{r as y,j as e,L as k,d as P}from"./main-149.js";import{n as S,q as V,_ as c,f as H,p as T,m as z,o as Y,r as Z}from"./bi.738.82.js";import{f as B,g as W}from"./bi.853.776.js";import{T as I}from"./bi.44.702.js";import{T as D}from"./bi.653.689.js";function G({groundhoggConf:a,setGroundhoggConf:i,formFields:t}){var b,M,_,$;const[s,m]=y.useState(!1),[r,N]=y.useState({show:!1,action:()=>{}}),h=(d,u)=>{var O,q;const F=p({},a);u==="tag"&&((O=d.target)!=null&&O.checked?F.actions.tags=!0:delete F.actions.tags),u==="optin_status_open"&&((q=d.target)!=null&&q.checked?F.optin_status_open=!0:delete F.optin_status_open),i(p({},F))},j=()=>{N({show:!1})},v=d=>{const u=p({},a);d?u.actions.tags=d:delete u.actions.tags,i(p({},u))},l=d=>{const u=p({},a);d?u.optin_status=d:u.optin_status="1",i(p({},u))},x=()=>{N({show:"tag"})},w=()=>{N({show:"optin_status"})},o=[{type:"group",title:"Groundhogg Tags",childs:(((b=a==null?void 0:a.default)==null?void 0:b.tags)||[]).map(({tag_name:d})=>({label:d,value:`ground-${d}`}))},{type:"group",title:"Form Fields",childs:t.map(d=>({label:d.label,value:d.name}))},{type:"group",title:"Special Tags",childs:(M=S)==null?void 0:M.map(d=>({label:d.label,value:d.name}))}],n=[{label:"Unconfirmed",value:"1"},{label:"Confirmed",value:"2"},{label:"Unsubscribed",value:"3"},{label:"Weekly",value:"4"},{label:"Monthly",value:"5"},{label:"Bounced",value:"6"},{label:"Spam",value:"7"},{label:"Complained",value:"8"}];return e.jsxs("div",{className:"d-flx wdt-300",children:[e.jsxs("div",{className:"pos-rel d-flx w-8",children:[e.jsx(I,{action:x,children:e.jsx(V,{checked:((_=a==null?void 0:a.actions)==null?void 0:_.tags)||!1,onChange:d=>h(d,"tag"),className:"wdt-200 mt-4 mr-2",value:"tags",title:c("Add Tags","bit-integrations"),subTitle:c("Add Contact Tag","bit-integrations")})}),e.jsxs(H,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:c("Ok","bit-integrations"),show:r.show==="tag",close:j,action:j,title:c("Tags","bit-integrations"),children:[e.jsx("div",{className:"btcd-hr mt-2 mb-2"}),e.jsx("div",{className:"mt-2",children:c("Select tag","bit-integrations")}),s?e.jsx(k,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):e.jsxs("div",{className:"flx flx-between mt-2",children:[e.jsx(T,{options:o,className:"msl-wrp-options",defaultValue:($=a.actions)==null?void 0:$.tags,onChange:d=>v(d),customValue:!0}),e.jsx("button",{onClick:()=>B(null,a,i,m),className:"icn-btn sh-sm ml-2 mr-4 tooltip",style:{"--tooltip-txt":`'${c("Refresh Groundhogg Tags","bit-integrations")}'`},type:"button",disabled:s,children:"↻"})]})]})]}),e.jsxs("div",{className:"pos-rel d-flx w-8",children:[e.jsx(I,{action:w,children:e.jsx(V,{checked:(a==null?void 0:a.optin_status_open)||!1,onChange:d=>h(d,"optin_status_open"),className:"wdt-200 mt-4 mr-2",value:"optin_status_open",title:c("Optin Status ","bit-integrations"),subTitle:c("Add optin status ","bit-integrations")})}),e.jsxs(H,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:c("Ok","bit-integrations"),show:r.show==="optin_status",close:j,action:j,title:c("Optin status","bit-integrations"),children:[e.jsx("div",{className:"btcd-hr mt-2 mb-2"}),e.jsx("div",{className:"mt-2",children:c("Select Optin status","bit-integrations")}),s?e.jsx(k,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):e.jsx("div",{className:"flx flx-between mt-2",children:e.jsx(T,{options:n,className:"msl-wrp-options",defaultValue:a.optin_status,onChange:d=>l(d),singleSelect:!0})})]})]})]})}const f=(a,i,t)=>{const s=p({},i);s.field_map.splice(a,0,{}),t(p({},s))},C=(a,i,t)=>{const s=p({},i);s.field_map.length>1&&s.field_map.splice(a,1),t(p({},s))},J=(a,i,t)=>{const s=p({},i);s.field_map_meta.splice(a,0,{}),t(p({},s))},g=(a,i,t)=>{const s=p({},i);s.field_map_meta.length>1&&s.field_map_meta.splice(a,1),t(p({},s))},U=(a,i,t,s)=>{const m=p({},t);m.field_map[i][a.target.name]=a.target.value,a.target.value==="custom"&&(m.field_map[i].customValue=""),s(p({},m))},L=(a,i,t,s)=>{const m=p({},t);m.field_map_meta[i][a.target.name]=a.target.value,a.target.value==="custom"&&(m.field_map_meta[i].customMetaFormValue=""),s(p({},m))},ee=(a,i,t,s)=>{const m=p({},t);m.field_map_meta[i].customMetaFormValue=a,s(p({},m))};function te({i:a,formFields:i,field:t,groundhoggConf:s,setGroundhoggConf:m}){var v;y.useEffect(()=>{var l;if(((l=s==null?void 0:s.field_map)==null?void 0:l.length)===1&&t.GroundhoggMapField===""){const x=p({},s),w=W(x);x.field_map=w,m(x)}},[]);const r=(s==null?void 0:s.contactsFields.filter(l=>l.required===!0))||[],N=(s==null?void 0:s.contactsFields.filter(l=>l.required===!1))||[],h=P(z),{isPro:j}=h;return e.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:e.jsxs("div",{className:"pos-rel flx",children:[e.jsxs("div",{className:"flx integ-fld-wrp",children:[e.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:t.formField||"",onChange:l=>U(l,a,s,m),children:[e.jsx("option",{value:"",children:c("Select Field","bit-integrations")}),e.jsx("optgroup",{label:"Form Fields",children:i==null?void 0:i.map(l=>e.jsx("option",{value:l.name,children:l.label},`ff-rm-${l.name}`))}),e.jsx("option",{value:"custom",children:c("Custom...","bit-integrations")}),e.jsx("optgroup",{label:`General Smart Codes ${j?"":"(PRO)"}`,children:j&&((v=S)==null?void 0:v.map(l=>e.jsx("option",{value:l.name,children:l.label},`ff-gh-${l.name}`)))})]}),t.formField==="custom"&&e.jsx(D,{onChange:l=>Y(l,a,s,m),label:c("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:t.customValue,placeholder:c("Custom Value","bit-integrations"),formFields:i}),e.jsxs("select",{className:"btcd-paper-inp",disabled:a<r.length,name:"GroundhoggMapField",value:a<r.length?r[a].key||"":t.GroundhoggMapField||"",onChange:l=>U(l,a,s,m),children:[e.jsx("option",{value:"",children:c("Select Field","bit-integrations")}),a<r.length?e.jsx("option",{value:r[a].key,children:r[a].label},r[a].key):N.map(({key:l,label:x})=>e.jsx("option",{value:l,children:x},l))]})]}),a>=r.length&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>f(a,s,m),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),e.jsx("button",{onClick:()=>C(a,s,m),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:e.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function ae({i:a,formFields:i,field:t,groundhoggConf:s,setGroundhoggConf:m}){var v;y.useEffect(()=>{var l;if(((l=s==null?void 0:s.field_map_meta)==null?void 0:l.length)===1&&t.GroundhoggMetaMapField===""){const x=p({},s),w=W(x);x.field_map_meta=w,m(x)}},[]);const r=(s==null?void 0:s.contactMetaFields.filter(l=>l.required===!0))||[],N=(s==null?void 0:s.contactMetaFields.filter(l=>l.required===!1))||[],h=P(z),{isPro:j}=h;return e.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:e.jsxs("div",{className:"pos-rel flx",children:[e.jsxs("div",{className:"flx integ-fld-wrp",children:[e.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:t.formField||"",onChange:l=>L(l,a,s,m),children:[e.jsx("option",{value:"",children:c("Select Field","bit-integrations")}),e.jsx("optgroup",{label:"Form Fields",children:i==null?void 0:i.map(l=>e.jsx("option",{value:l.name,children:l.label},`ff-rm-${l.name}`))}),e.jsx("option",{value:"custom",children:c("Custom...","bit-integrations")}),e.jsx("optgroup",{label:`General Smart Codes ${j?"":"(PRO)"}`,children:j&&((v=S)==null?void 0:v.map(l=>e.jsx("option",{value:l.name,children:l.label},`ff-gh-${l.name}`)))})]}),t.formField==="custom"&&e.jsx(D,{onChange:l=>ee(l,a,s,m),label:c("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:t.customMetaFormValue,placeholder:c("Custom Value","bit-integrations"),formFields:i}),e.jsxs("select",{className:"btcd-paper-inp",disabled:a<r.length,name:"GroundhoggMetaMapField",value:a<r.length?r[a].key||"":t.GroundhoggMetaMapField||"",onChange:l=>L(l,a,s,m),children:[e.jsx("option",{value:"",children:c("Select Field","bit-integrations")}),a<r.length?e.jsx("option",{value:r[a].key,children:r[a].label},r[a].key):N.map(({key:l,label:x})=>e.jsx("option",{value:l,children:x},l))]})]}),a>=r.length&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>J(a,s,m),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),e.jsx("button",{onClick:()=>g(a,s,m),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:e.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function pe({formFields:a,handleInput:i,groundhoggConf:t,setGroundhoggConf:s,isLoading:m,setIsLoading:r,setSnackbar:N}){var A,o;const h=(n,b)=>{var _;const M=p({},t);b==="showMeta"&&((_=n.target)!=null&&_.checked?M.showMeta=!0:delete M.showMeta),s(p({},M))},j=n=>{const b=p({},t);n?b.addTagToUser=n:b.addTagToUser="",s(p({},b))},v=n=>{const b=p({},t);n?b.emailAddress=n:b.emailAddress="",s(p({},b))},l=(((A=t==null?void 0:t.default)==null?void 0:A.tags)||[]).map(({tag_name:n})=>({label:n,value:`ground-${n}`})),x=a.map(n=>({label:n.label,value:n.name})),w=[{type:"group",title:"Groundhogg Tags",childs:l},{type:"group",title:"Form Fields",childs:x},{type:"group",title:"Special Tags",childs:(o=S)==null?void 0:o.map(n=>({label:n.label,value:n.name}))}];return e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("b",{className:"wdt-200 d-in-b",children:c("Actions:","bit-integrations")}),e.jsxs("select",{onChange:i,name:"mainAction",value:t.mainAction,className:"btcd-paper-inp w-5",children:[e.jsx("option",{value:"",children:c("Select Actions","bit-integrations")}),t.allActions&&t.allActions.map(({key:n,label:b})=>e.jsx("option",{value:n,children:b},n))]}),e.jsx("br",{}),e.jsx("br",{}),t.mainAction==="2"&&e.jsxs("div",{className:"d-flx",children:[e.jsx("b",{className:"wdt-200 d-in-b mt-3 mt-i-3",children:c("Email:","bit-integrations")}),e.jsx(T,{options:x,className:"btcd-paper-drpdwn w-5",defaultValue:t.emailAddress,onChange:n=>v(n),singleSelect:!0,closeOnSelect:!0})]}),m&&e.jsx(k,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),e.jsx("br",{}),t.mainAction==="1"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-5",children:e.jsx("b",{className:"wdt-100",children:c("Field Map","bit-integrations")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:c("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:c("Groundhogg Fields","bit-integrations")})})]}),t==null?void 0:t.field_map.map((n,b)=>e.jsx(te,{i:b,field:n,groundhoggConf:t,formFields:a,setGroundhoggConf:s},`rp-m-${b+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>Z(t.field_map.length,t,s,!1),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsx(V,{checked:(t==null?void 0:t.showMeta)||!1,onChange:n=>h(n,"showMeta"),className:"wdt-200 mt-4 mr-2",value:"showMeta",title:c("Add Meta field","bit-integrations")})]}),e.jsx("br",{}),t.mainAction==="1"&&t.showMeta&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:c("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:c("Groundhogg Meta Fields","bit-integrations")})})]}),t==null?void 0:t.field_map_meta.map((n,b)=>e.jsx(ae,{i:b,field:n,groundhoggConf:t,formFields:a,setGroundhoggConf:s},`rp-m-${b+9}`))]}),t.mainAction==="1"&&t.showMeta&&e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>J(t.field_map_meta.length,t,s),className:"icn-btn sh-sm",type:"button",children:"+"})}),t.mainAction==="2"&&e.jsxs("div",{className:"d-flx",children:[e.jsx("b",{className:"wdt-200 d-in-b mt-3 mt-i-3",children:c("All Tags:","bit-integrations")}),e.jsx(T,{options:w,className:"btcd-paper-drpdwn w-5",defaultValue:t.addTagToUser,onChange:n=>j(n),customValue:!0}),e.jsx("button",{onClick:()=>B(null,t,s,r),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${c("Refresh Groundhogg Tags","bit-integrations")}'`},type:"button",disabled:m,children:"↻"})]}),e.jsx("br",{}),e.jsx("br",{}),t.mainAction==="1"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-4",children:e.jsx("b",{className:"wdt-100",children:c("Actions","bit-integrations")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsx(G,{groundhoggConf:t,setGroundhoggConf:s,formFields:a})]})]})}export{pe as G};
