var k=Object.defineProperty;var x=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var g=(e,s,t)=>s in e?k(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,d=(e,s)=>{for(var t in s||(s={}))w.call(s,t)&&g(e,t,s[t]);if(x)for(var t of x(s))L.call(s,t)&&g(e,t,s[t]);return e};import{d as q,j as a}from"./main-149.js";import{c as F,d as v,_ as n,m as M,n as $,o as B}from"./bi.738.82.js";import{T as P}from"./bi.653.689.js";const G=(e,s,t,i,r,m,c,u)=>{const p=d({},s),{name:o}=e.target;e.target.value!==""?p[o]=e.target.value:delete p[o],t(d({},p))},V=(e,s,t,i)=>{t(!0);const r={api_key:e.api_key,sendy_url:e.sendy_url},m=F(r,"get_all_brands").then(c=>{if(c&&c.success){const u=d({},e);return u.default||(u.default={}),c.data&&(u.default.brandList=c.data),s(d({},u)),t(!1),"BrandList refreshed successfully"}else return t(!1),"BrandList refresh failed. please try again"});v.promise(m,{success:c=>c,error:n("Error Occurred","bit-integrations"),loading:n("Loading Brand...")})},j=(e,s,t,i)=>{t(!0);const r={api_key:e.api_key,sendy_url:e.sendy_url,brand_id:e.brand_id},m=F(r,"get_all_lists_from_sendy").then(c=>{if(c&&c.success){const u=d({},e);return u.default||(u.default={}),c.data&&(u.default.lists=c.data),s(d({},u)),t(!1),"Lists refreshed successfully"}else return t(!1),"Lists refresh failed. please try again"});v.promise(m,{success:c=>c,error:n("Error Occurred","bit-integrations"),loading:n("Loading Lists...")})},T=e=>{const s=e==null?void 0:e.subscriberFields.filter(t=>t.required===!0);return s.length>0?s.map(t=>({formField:"",sendyField:t.key})):[{formField:"",sendyField:""}]},z=e=>!((e!=null&&e.field_map?e.field_map.filter(t=>!t.formField||!t.sendyField||!t.formField==="custom"&&!t.customValue):[]).length>0),N=(e,s,t)=>{const i=d({},s);i.field_map.splice(e,0,{}),t(d({},i))},A=(e,s,t)=>{const i=d({},s);i.field_map.length>1&&i.field_map.splice(e,1),t(d({},i))},_=(e,s,t,i)=>{const r=d({},t);r.field_map[s][e.target.name]=e.target.value,e.target.value==="custom"&&(r.field_map[s].customValue=""),i(d({},r))};function E({i:e,formFields:s,field:t,sendyConf:i,setSendyConf:r}){var o,b;if(((o=i==null?void 0:i.field_map)==null?void 0:o.length)===1&&t.sendyField===""){const l=d({},i),h=T(l);l.field_map=h,r(l)}const m=(i==null?void 0:i.subscriberFields.filter(l=>l.required===!0))||[],c=(i==null?void 0:i.subscriberFields.filter(l=>l.required===!1))||[],u=q(M),{isPro:p}=u;return a.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:a.jsxs("div",{className:"pos-rel flx",children:[a.jsxs("div",{className:"flx integ-fld-wrp",children:[a.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:t.formField||"",onChange:l=>_(l,e,i,r),children:[a.jsx("option",{value:"",children:n("Select Field","bit-integrations")}),a.jsx("optgroup",{label:"Form Fields",children:s==null?void 0:s.map(l=>a.jsx("option",{value:l.name,children:l.label},`ff-rm-${l.name}`))}),a.jsx("option",{value:"custom",children:n("Custom...","bit-integrations")}),a.jsx("optgroup",{label:`General Smart Codes ${p?"":"(PRO)"}`,children:p&&((b=$)==null?void 0:b.map(l=>a.jsx("option",{value:l.name,children:l.label},`ff-rm-${l.name}`)))})]}),t.formField==="custom"&&a.jsx(P,{onChange:l=>B(l,e,i,r),label:n("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:t.customValue,placeholder:n("Custom Value","bit-integrations"),formFields:s}),a.jsxs("select",{className:"btcd-paper-inp",disabled:e<m.length,name:"sendyField",value:e<m?m[e].label||"":t.sendyField||"",onChange:l=>_(l,e,i,r),children:[a.jsx("option",{value:"",children:n("Select Field","bit-integrations")}),e<m.length?a.jsx("option",{value:m[e].key,children:m[e].label},m[e].key):c.map(({key:l,label:h})=>a.jsx("option",{value:l,children:h},l))]})]}),e>=m.length&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>N(e,i,r),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),a.jsx("button",{onClick:()=>A(e,i,r),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:a.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function D({formFields:e,handleInput:s,sendyConf:t,setSendyConf:i,isLoading:r,setIsLoading:m,setSnackbar:c}){var p,o;const u=b=>{const l=d({},t),{name:h}=b.target;b.target.value!==""?l[h]=b.target.value:delete l[h],h==="brand_id"&&j(l,i,m),i(d({},l))};return a.jsxs(a.Fragment,{children:[a.jsx("br",{}),a.jsx("b",{className:"wdt-200 d-in-b",children:n("Brand:","bit-integrations")}),a.jsxs("select",{onChange:u,name:"brand_id",value:t.brand_id,className:"btcd-paper-inp w-5",children:[a.jsx("option",{value:"test",children:n("Select Brand","bit-integrations")}),((p=t==null?void 0:t.default)==null?void 0:p.brandList)&&t.default.brandList.map(({brandId:b,brandName:l})=>a.jsx("option",{value:b,children:l},b))]}),a.jsx("button",{onClick:()=>V(t,i,m),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${n("Fetch All List","bit-integrations")}'`},type:"button",disabled:r,children:"↻"}),a.jsx("br",{}),a.jsx("br",{}),(t==null?void 0:t.brand_id)&&a.jsxs(a.Fragment,{children:[a.jsx("b",{className:"wdt-200 d-in-b",children:n("List:","bit-integrations")}),a.jsxs("select",{onChange:u,name:"list_id",value:t.list_id,className:"btcd-paper-inp w-5",children:[a.jsx("option",{value:"test",children:n("Select List","bit-integrations")}),((o=t==null?void 0:t.default)==null?void 0:o.lists)&&t.default.lists.map(({listId:b,listName:l})=>a.jsx("option",{value:b,children:l},b))]}),a.jsx("button",{onClick:()=>j(t,i,m),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${n("Fetch All List","bit-integrations")}'`},type:"button",disabled:r,children:"↻"})]}),a.jsx("br",{}),a.jsx("div",{className:"mt-5",children:a.jsx("b",{className:"wdt-100",children:n("Field Map","bit-integrations")})}),a.jsx("div",{className:"btcd-hr mt-1"}),a.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[a.jsx("div",{className:"txt-dp",children:a.jsx("b",{children:n("Form Fields","bit-integrations")})}),a.jsx("div",{className:"txt-dp",children:a.jsx("b",{children:n("Sendy Fields","bit-integrations")})})]}),t==null?void 0:t.field_map.map((b,l)=>a.jsx(E,{i:l,field:b,sendyConf:t,formFields:e,setSendyConf:i,setSnackbar:c},`rp-m-${l+9}`)),a.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:a.jsx("button",{onClick:()=>N(t.field_map.length,t,i),className:"icn-btn sh-sm",type:"button",children:"+"})}),a.jsx("br",{}),a.jsx("br",{})]})}export{D as S,z as c,G as h};
