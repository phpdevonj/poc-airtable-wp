var h=Object.defineProperty;var D=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var k=(r,l,a)=>l in r?h(r,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[l]=a,c=(r,l)=>{for(var a in l||(l={}))M.call(l,a)&&k(r,a,l[a]);if(D)for(var a of D(l))F.call(l,a)&&k(r,a,l[a]);return r};import{u as B,r as i,j as s}from"./main-149.js";import{e as x,_ as j,I as H,F as v,d as t}from"./bi.738.82.js";import{S as Y}from"./bi.384.918.js";import U from"./bi.107.302.js";import{h as G,c as I,l as w}from"./bi.918.854.js";import{I as W}from"./bi.325.855.js";import"./bi.452.742.js";function ee({formFields:r,setFlow:l,flow:a,allIntegURL:E}){const A=B(),[q,T]=i.useState(!1),[y,b]=i.useState({}),[d,f]=i.useState(1),[O,S]=i.useState({show:!1}),p=[{key:"ORGANISATION_NAME",label:"Name",required:!0},{key:"PHONE",label:"Phone",required:!1},{key:"PHONE_FAX",label:"Fax",required:!1},{key:"WEBSITE",label:"Website",required:!1},{key:"SOCIAL_FACEBOOK",label:"Facebook",required:!1},{key:"SOCIAL_LINKEDIN",label:"Linkedin",required:!1},{key:"SOCIAL_TWITTER",label:"Twitter",required:!1},{key:"ADDRESS_BILLING_STREET",label:"Address Billing Street",required:!1},{key:"ADDRESS_BILLING_CITY",label:"Address Billing City",required:!1},{key:"ADDRESS_BILLING_STATE",label:"Address Billing State",required:!1},{key:"ADDRESS_BILLING_COUNTRY",label:"Address Billing Country",required:!1},{key:"ADDRESS_BILLING_POSTCODE",label:"Address Billing Postcode",required:!1},{key:"ADDRESS_SHIP_STREET",label:"Address Shipping Street",required:!1},{key:"ADDRESS_SHIP_STATE",label:"Address Shipping State",required:!1},{key:"ADDRESS_SHIP_POSTCODE",label:"Address Shipping Postcode",required:!1},{key:"ADDRESS_SHIP_COUNTRY",label:"Address Shipping Country",required:!1}],N=[{key:"TITLE",label:"Task Name",required:!0},{key:"DUE_DATE",label:"Due Date",required:!1},{key:"COMPLETED_DATE_UTC",label:"Completed Date",required:!1},{key:"DETAILS",label:"Description",required:!1},{key:"PERCENT_COMPLETE",label:"Progress ( % )",required:!1},{key:"START_DATE",label:"Start Date",required:!1}],R=[{key:"FIRST_NAME",label:"First Name",required:!1},{key:"LAST_NAME",label:"Last Name",required:!0},{key:"TITLE",label:"Title",required:!1},{key:"ORGANISATION_NAME",label:"Organization",required:!1},{key:"LEAD_RATING",label:"Lead Rating",required:!1},{key:"EMAIL",label:"Email Address",required:!1},{key:"PHONE",label:"Phone",required:!1},{key:"MOBILE",label:"Mobile Phone",required:!1},{key:"FAX",label:"Fax",required:!1},{key:"WEBSITE",label:"Website",required:!1},{key:"INDUSTRY",label:"Industry",required:!1},{key:"EMPLOYEE_COUNT",label:"Number of Employees",required:!1},{key:"ADDRESS_STREET",label:"Address Street",required:!1},{key:"ADDRESS_CITY",label:"Address City",required:!1},{key:"ADDRESS_STATE",label:"Address State",required:!1},{key:"ADDRESS_POSTCODE",label:"Address Postcode",required:!1},{key:"ADDRESS_COUNTRY",label:"Address Country",required:!1},{key:"LEAD_DESCRIPTION",label:"Description",required:!1}],L=[{key:"FIRST_NAME",label:"First Name",required:!0},{key:"EMAIL_ADDRESS",label:"Email",required:!0},{key:"LAST_NAME",label:"Last Name",required:!1},{key:"TITLE",label:"Title",required:!1},{key:"PHONE",label:"Phone",required:!1},{key:"PHONE_FAX",label:"Fax",required:!1},{key:"DATE_OF_BIRTH",label:"Date of Birth",required:!1},{key:"SOCIAL_FACEBOOK",label:"Facebook",required:!1},{key:"SOCIAL_LINKEDIN",label:"Linkedin",required:!1},{key:"SOCIAL_TWITTER",label:"Twitter",required:!1},{key:"ADDRESS_MAIL_STREET",label:"Address Mail Street",required:!1},{key:"ADDRESS_MAIL_CITY",label:"Address Mail City",required:!1},{key:"ADDRESS_MAIL_STATE",label:"Address Mail State",required:!1},{key:"ADDRESS_MAIL_COUNTRY",label:"Address Mail Country",required:!1},{key:"ADDRESS_MAIL_POSTCODE",label:"Address Mail Postcode",required:!1},{key:"ADDRESS_OTHER_STREET",label:"Address Other Street",required:!1},{key:"ADDRESS_OTHER_STATE",label:"Address Other State",required:!1},{key:"ADDRESS_OTHER_POSTCODE",label:"Address Other Postcode",required:!1},{key:"ADDRESS_OTHER_COUNTRY",label:"Address Other Country",required:!1}],m=[{key:"OPPORTUNITY_NAME",label:"Opportunity Name",required:!0},{key:"OPPORTUNITY_DETAILS",label:"Opportunity Details",required:!1},{key:"BID_AMOUNT",label:"Bid Amount",required:!1},{key:"ACTUAL_CLOSE_DATE",label:"Actual Close Date",required:!1},{key:"PROBABILITY",label:"Probability Of Winning",required:!1},{key:"FORECAST_CLOSE_DATE",label:"Forecast Close Date",required:!1}],C=[{key:"PROJECT_NAME",label:"Project Name",required:!0},{key:"PROJECT_DETAILS",label:"Description",required:!1}],[e,n]=i.useState({name:"Insightly",type:"Insightly",api_key:"",api_url:"",field_map:[{formField:"",insightlyFormField:""}],actionName:"",organisationFields:p,contactFields:L,taskFields:N,leadFields:R,opportunityFields:m,projectFields:C,actions:{}}),P=()=>{T(!0),v(a,l,E,e,A,"","",T).then(u=>{var _;u.success?(t.success((_=u.data)==null?void 0:_.msg),A(E)):t.error(u.data||u)})},g=o=>{if(setTimeout(()=>{document.getElementById("btcd-settings-wrp").scrollTop=0},300),!I(e)){t.error("Please map mandatory fields");return}if(e.actionName==="opportunity"||e.actionName==="project"){if(!e.selectedCRMPipeline){t.error("Please select a pipeline");return}if(!e.selectedCRMPipelineStages){t.error("Please select a pipeline stage");return}}if(e.actionName==="lead"&&!w(e)){t.error("Please select Lead Status or Lead Source");return}e.field_map.length>0&&f(o)};return s.jsxs("div",{children:[s.jsx(x,{snack:O,setSnackbar:S}),s.jsx("div",{className:"txt-center mt-2",children:s.jsx(Y,{step:3,active:d})}),s.jsx(U,{insightlyConf:e,setInsightlyConf:n,step:d,setStep:f,loading:y,setLoading:b,setSnackbar:S}),s.jsxs("div",{className:"btcd-stp-page",style:c({},d===2&&{width:900,height:"auto",overflow:"visible"}),children:[s.jsx(W,{formFields:r,handleInput:o=>G(o,e,n),insightlyConf:e,setInsightlyConf:n,loading:y,setLoading:b,setSnackbar:S}),(e==null?void 0:e.actionName)&&s.jsxs("button",{onClick:()=>g(3),disabled:!I(e),className:"btn f-right btcd-btn-lg green sh-sm flx",type:"button",children:[j("Next","bit-integrations")," ","Â ",s.jsx("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]}),(e==null?void 0:e.actionName)&&s.jsx(H,{step:d,saveConfig:()=>P(),isLoading:q,dataConf:e,setDataConf:n,formFields:r})]})}export{ee as default};
