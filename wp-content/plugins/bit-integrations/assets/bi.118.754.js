var M=Object.defineProperty;var N=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var F=(e,c,a)=>c in e?M(e,c,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[c]=a,l=(e,c)=>{for(var a in c||(c={}))A.call(c,a)&&F(e,a,c[a]);if(N)for(var a of N(c))k.call(c,a)&&F(e,a,c[a]);return e};import{r as o,j as s,L as _,d as S}from"./main-149.js";import{q as $,_ as n,f as B,p as I,m as V,n as P,r as R}from"./bi.738.82.js";import{g as q,f as w,a as L}from"./bi.23.755.js";import{T as E}from"./bi.653.689.js";function H({trelloConf:e,setTrelloConf:c,formFields:a}){var i;const[t,d]=o.useState(!1),[m,r]=o.useState({show:!1,action:()=>{}}),u=(b,j)=>{var v;const g=l({},e);j==="tag"&&((v=b.target)!=null&&v.checked?(g.actions.tag=!0,r({show:"tag"})):(r({show:!1}),delete g.actions.tag)),c(l({},g))},h=()=>{r({show:!1})},x=b=>{const j=l({},e);j.pos=b,c(j)},p=[{label:"Top",value:"top"},{label:"Bottom",value:"bottom"}];return s.jsxs("div",{className:"pos-rel d-flx w-8",children:[s.jsx($,{checked:((i=e==null?void 0:e.actions)==null?void 0:i.tag)||!1,onChange:b=>u(b,"tag"),className:"wdt-200 mt-4 mr-2",value:"tag",title:n("Add Position","bit-integrations"),subTitle:n("Add Card Position","bit-integrations")}),s.jsxs(B,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:n("Ok","bit-integrations"),show:m.show==="tag",close:h,action:h,title:n("Position","bit-integrations"),children:[s.jsx("div",{className:"btcd-hr mt-2 mb-2"}),s.jsx("div",{className:"mt-2",children:n("Select Card Position","bit-integrations")}),t?s.jsx(_,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):s.jsx("div",{className:"flx flx-between mt-2",children:s.jsx(I,{options:p,className:"msl-wrp-options",singleSelect:!0,defaultValue:e.pos,onChange:b=>x(b)})})]})]})}const O=(e,c,a)=>{const t=l({},c);t.field_map.splice(e,0,{}),a(l({},t))},G=(e,c,a)=>{const t=l({},c);t.field_map.length>1&&t.field_map.splice(e,1),a(l({},t))},y=(e,c,a,t)=>{const d=l({},a);d.field_map[c][e.target.name]=e.target.value,e.target.value==="custom"&&(d.field_map[c].customValue=""),t(l({},d))},T=(e,c,a,t)=>{const d=l({},a);d.field_map[c].customValue=e,t(l({},d))};function z({i:e,formFields:c,field:a,trelloConf:t,setTrelloConf:d}){var x,p;if(((x=t==null?void 0:t.field_map)==null?void 0:x.length)===1&&a.trelloFormField===""){const i=l({},t),b=q(i);i.field_map=b,d(i)}const m=(t==null?void 0:t.cardFields.filter(i=>i.required===!0))||[],r=(t==null?void 0:t.cardFields.filter(i=>i.required===!1))||[],u=S(V),{isPro:h}=u;return s.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:s.jsxs("div",{className:"pos-rel flx",children:[s.jsxs("div",{className:"flx integ-fld-wrp",children:[s.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:a.formField||"",onChange:i=>y(i,e,t,d),children:[s.jsx("option",{value:"",children:n("Select Field","bit-integrations")}),s.jsx("optgroup",{label:"Form Fields",children:c==null?void 0:c.map(i=>s.jsx("option",{value:i.name,children:i.label},`ff-rm-${i.name}`))}),s.jsx("option",{value:"custom",children:n("Custom...","bit-integrations")}),s.jsx("optgroup",{label:`General Smart Codes ${h?"":"(PRO)"}`,children:h&&((p=P)==null?void 0:p.map(i=>s.jsx("option",{value:i.name,children:i.label},`ff-rm-${i.name}`)))})]}),a.formField==="custom"&&s.jsx(E,{onChange:i=>T(i,e,t,d),label:n("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:a.customValue,placeholder:n("Custom Value","bit-integrations"),formFields:c}),s.jsxs("select",{className:"btcd-paper-inp",disabled:e<m.length,name:"trelloFormField",value:e<m.length?m[e].key||"":a.trelloFormField||"",onChange:i=>y(i,e,t,d),children:[s.jsx("option",{value:"",children:n("Select Field","bit-integrations")}),e<m.length?s.jsx("option",{value:m[e].key,children:m[e].label},m[e].key):r.map(({key:i,label:b})=>s.jsx("option",{value:i,children:b},i))]})]}),e>=m.length&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>O(e,t,d),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),s.jsx("button",{onClick:()=>G(e,t,d),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:s.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function W({formFields:e,handleInput:c,trelloConf:a,setTrelloConf:t,isLoading:d,setIsLoading:m,setSnackbar:r}){var u,h,x;return o.useEffect(()=>{a!=null&&a.boardId&&w(a,t,m,r)},[a==null?void 0:a.boardId]),s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsx("b",{className:"wdt-200 d-in-b",children:n("Boards:","bit-integrations")}),s.jsxs("select",{onChange:c,name:"boardId",value:a.boardId,className:"btcd-paper-inp w-5",children:[s.jsx("option",{value:"",children:n("Select Board","bit-integrations")}),((u=a==null?void 0:a.default)==null?void 0:u.allBoardlist)&&a.default.allBoardlist.map(({boardId:p,boardName:i})=>s.jsx("option",{value:p,children:i},p))]}),s.jsx("button",{onClick:()=>L(a,t,m,r),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${n("Fetch All Recipients","bit-integrations")}'`},type:"button",disabled:d,children:"↻"}),s.jsx("br",{}),((h=a==null?void 0:a.default)==null?void 0:h.alllists)&&s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsx("b",{className:"wdt-200 d-in-b",children:n("Lists:","bit-integrations")}),s.jsxs("select",{onChange:c,name:"listId",value:a.listId,className:"btcd-paper-inp w-5",children:[s.jsx("option",{value:"",children:n("Select List","bit-integrations")}),((x=a==null?void 0:a.default)==null?void 0:x.alllists)&&a.default.alllists.map(({listId:p,listName:i})=>s.jsx("option",{value:p,children:i},p))]}),s.jsx("button",{onClick:()=>w(a,t,m,r),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${n("Fetch All Recipients","bit-integrations")}'`},type:"button",disabled:d,children:"↻"}),s.jsx("br",{})]}),s.jsx("br",{}),d&&s.jsx(_,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),s.jsx("div",{className:"mt-5",children:s.jsx("b",{className:"wdt-100",children:n("Field Map","bit-integrations")})}),s.jsx("div",{className:"btcd-hr mt-1"}),s.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:n("Form Fields","bit-integrations")})}),s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:n("Trello Fields","bit-integrations")})})]}),(a==null?void 0:a.listId)&&(a==null?void 0:a.field_map.map((p,i)=>s.jsx(z,{i,field:p,trelloConf:a,formFields:e,setTrelloConf:t,setSnackbar:r},`rp-m-${i+9}`))),s.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:s.jsx("button",{onClick:()=>R(a.field_map.length,a,t,!1),className:"icn-btn sh-sm",type:"button",children:"+"})}),s.jsx("br",{}),s.jsx("br",{}),s.jsx("div",{className:"mt-4",children:s.jsx("b",{className:"wdt-100",children:n("Actions","bit-integrations")})}),s.jsx("div",{className:"btcd-hr mt-1"}),s.jsx(H,{trelloConf:a,setTrelloConf:t,formFields:e})]})}export{W as T};
