var I=Object.defineProperty;var y=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var _=(s,c,t)=>c in s?I(s,c,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[c]=t,i=(s,c)=>{for(var t in c||(c={}))V.call(c,t)&&_(s,t,c[t]);if(y)for(var t of y(c))q.call(c,t)&&_(s,t,c[t]);return s};import{r as j,j as e,L as v,d as $}from"./main-149.js";import{q as A,_ as a,f as S,p as F,c as R,d as k,m as E,n as H,r as L,N as O}from"./bi.738.82.js";import{T as P}from"./bi.653.689.js";function B({affiliateConf:s,setAffiliateConf:c,formFields:t}){var x,r;const[l,d]=j.useState(!1),[m,o]=j.useState({show:!1,action:()=>{}}),b=(n,u)=>{var N,w;const h=i({},s);u==="status"&&((N=n.target)!=null&&N.checked?(h.actions.status=!0,o({show:"status"})):(o({show:!1}),delete h.actions.status)),u==="type"&&((w=n.target)!=null&&w.checked?(h.actions.type=!0,o({show:"type"})):(o({show:!1}),delete h.actions.type)),c(i({},h))},p=()=>{o({show:!1})},g=(n,u)=>{const h=i({},s);h[u]=n,c(i({},h))};return e.jsxs("div",{className:"pos-rel d-flx w-8",children:[e.jsx(A,{checked:((x=s==null?void 0:s.actions)==null?void 0:x.status)||!1,onChange:n=>b(n,"status"),className:"wdt-200 mt-4 mr-2",value:"status",title:a("Add Status","bit-integrations"),subTitle:a("Add Status ","bit-integrations")}),e.jsxs(S,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:a("Ok","bit-integrations"),show:m.show==="status",close:p,action:p,title:a("Status","bit-integrations"),children:[e.jsx("div",{className:"btcd-hr mt-2 mb-2"}),e.jsx("div",{className:"mt-2",children:a("Select status of referral ","bit-integrations")}),l?e.jsx(v,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):e.jsx("div",{className:"flx flx-between mt-2",children:e.jsx(F,{className:"msl-wrp-options",defaultValue:s==null?void 0:s.statusId,options:s==null?void 0:s.allStatus.map(n=>({label:n.label,value:n.key})),onChange:n=>g(n,"statusId"),singleSelect:!0})})]}),e.jsx(A,{checked:((r=s==null?void 0:s.actions)==null?void 0:r.type)||!1,onChange:n=>b(n,"type"),className:"wdt-200 mt-4 mr-2",value:"type",title:a("Add Type","bit-integrations"),subTitle:a("Add Type","bit-integrations")}),e.jsxs(S,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:a("Ok","bit-integrations"),show:m.show==="type",close:p,action:p,title:a("Type","bit-integrations"),children:[e.jsx("div",{className:"btcd-hr mt-2 mb-2"}),e.jsx("div",{className:"mt-2",children:a("Select Type of referral","bit-integrations")}),l?e.jsx(v,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):e.jsx("div",{className:"flx flx-between mt-2",children:e.jsx(F,{className:"msl-wrp-options",defaultValue:s==null?void 0:s.referralId,options:s.allReferralType.map(n=>({label:n.label,value:n.key})),onChange:n=>g(n,"referralId"),singleSelect:!0})})]})]})}const Y=(s,c,t,l,d,m)=>{const o=i({},c),{name:b}=s.target;s.target.value!==""?o[b]=s.target.value:delete o[b],o[s.target.name]=s.target.value,t(i({},o))},M=(s,c,t,l)=>{t(!0),R(null,"affiliate_fetch_all_affiliate").then(d=>{if(d&&d.success){const m=i({},s);m.default||(m.default={}),d.data&&(m.default.allAffiliate=d.data),c(i({},m)),t(!1),k.success(a("All affiliate fetched successfully","bit-integrations"));return}t(!1),k.error(a("All affiliate fetch failed. please try again","bit-integrations"))}).catch(()=>t(!1))},D=s=>{const c=s==null?void 0:s.createAffiliateFields.filter(t=>t.required===!0);return c.length>0?c.map(t=>({formField:"",affiliateFormField:t.key})):[{formField:"",affiliateFormField:""}]},Z=s=>!((s.field_map?s.field_map.filter(t=>!t.formField||!t.affiliateFormField):[]).length>0),G=(s,c,t)=>{const l=i({},c);l.field_map.splice(s,0,{}),t(i({},l))},U=(s,c,t)=>{const l=i({},c);l.field_map.length>1&&l.field_map.splice(s,1),t(i({},l))},T=(s,c,t,l)=>{const d=i({},t);d.field_map[c][s.target.name]=s.target.value,s.target.value==="custom"&&(d.field_map[c].customValue=""),l(i({},d))},z=(s,c,t,l)=>{const d=i({},t);d.field_map[c].customValue=s.target.value,l(i({},d))};function J({i:s,formFields:c,field:t,affiliateConf:l,setAffiliateConf:d}){var g,x;if(((g=l==null?void 0:l.field_map)==null?void 0:g.length)===1&&t.affiliateFormField===""){const r=i({},l),n=D(r);r.field_map=n,d(r)}const m=(l==null?void 0:l.createAffiliateFields.filter(r=>r.required===!0))||[],o=(l==null?void 0:l.createAffiliateFields.filter(r=>r.required===!1))||[],b=$(E),{isPro:p}=b;return e.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:e.jsxs("div",{className:"pos-rel flx",children:[e.jsxs("div",{className:"flx integ-fld-wrp",children:[e.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:t.formField||"",onChange:r=>T(r,s,l,d),children:[e.jsx("option",{value:"",children:a("Select Field","bit-integrations")}),e.jsx("optgroup",{label:"Form Fields",children:c==null?void 0:c.map(r=>e.jsx("option",{value:r.name,children:r.label},`ff-rm-${r.name}`))}),e.jsx("option",{value:"custom",children:a("Custom...","bit-integrations")}),e.jsx("optgroup",{label:`General Smart Codes ${p?"":"(PRO)"}`,children:p&&((x=H)==null?void 0:x.map(r=>e.jsx("option",{value:r.name,children:r.label},`ff-rm-${r.name}`)))})]}),t.formField==="custom"&&e.jsx(P,{onChange:r=>z(r,s,l,d),label:a("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:t.customValue,placeholder:a("Custom Value","bit-integrations"),formFields:c}),e.jsxs("select",{className:"btcd-paper-inp",disabled:s<m.length,name:"affiliateFormField",value:s<m.length?m[s].key||"":t.affiliateFormField||"",onChange:r=>T(r,s,l,d),children:[e.jsx("option",{value:"",children:a("Select Field","bit-integrations")}),s<m.length?e.jsx("option",{value:m[s].key,children:m[s].label},m[s].key):o.map(({key:r,label:n})=>e.jsx("option",{value:r,children:n},r))]})]}),s>=m.length&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>G(s,l,d),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),e.jsx("button",{onClick:()=>U(s,l,d),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:e.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function C({formFields:s,handleInput:c,affiliateConf:t,setAffiliateConf:l,isLoading:d,setIsLoading:m,setSnackbar:o,allIntegURL:b,isInfo:p,edit:g}){var r;j.useEffect(()=>{t.mainAction==="1"&&M(t,l,m)},[t.mainAction]);const x=(n,u)=>{const h=i({},t);h[u]=n,l(i({},h))};return e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("b",{className:"wdt-200 d-in-b",children:a("Actions:","bit-integrations")}),e.jsxs("select",{onChange:c,name:"mainAction",value:t==null?void 0:t.mainAction,className:"btcd-paper-inp w-5",children:[e.jsx("option",{value:"",children:a("Select Actions","bit-integrations")}),(t==null?void 0:t.allActions)&&t.allActions.map(({key:n,label:u})=>e.jsx("option",{value:n,children:u},n))]}),e.jsx("br",{}),e.jsx("br",{}),(t==null?void 0:t.mainAction)==="1"&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsxs("div",{className:"flx mt-4",children:[e.jsx("b",{className:"wdt-200 d-in-b",children:a("Select Affiliate: ","bit-integrations")}),e.jsx(F,{className:"w-5",defaultValue:t==null?void 0:t.affiliate_id,options:((r=t==null?void 0:t.default)==null?void 0:r.allAffiliate)&&t.default.allAffiliate.map(n=>({label:n.affiliate_name,value:n.affiliate_id.toString()})),onChange:n=>x(n,"affiliate_id"),singleSelect:!0}),e.jsx("button",{onClick:()=>M(t,l,m),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${a("Fetch All Affiliate List","bit-integrations")}'`},type:"button",disabled:d,children:"â†»"})]})]}),e.jsx("br",{}),e.jsx("br",{}),d&&e.jsx(v,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-4",children:e.jsx("b",{className:"wdt-100",children:a("Map Fields","bit-integrations")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Affiliate Fields","bit-integrations")})})]}),t.field_map.map((n,u)=>e.jsx(J,{i:u,field:n,affiliateConf:t,formFields:s,setAffiliateConf:l},`dash-m-${u+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>L(t.field_map.length,t,l),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("div",{className:"mt-4",children:e.jsx("b",{className:"wdt-100",children:a("Actions","bit-integrations")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsx(B,{affiliateConf:t,setAffiliateConf:l,formFields:s})]}),e.jsx("br",{}),e.jsx(O,{note:"Some integrations will only work for logged-in users."})]})}export{C as A,Z as c,Y as h};
