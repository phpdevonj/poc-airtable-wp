var P=Object.defineProperty;var j=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var v=(o,n,i)=>n in o?P(o,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[n]=i,h=(o,n)=>{for(var i in n||(n={}))T.call(n,i)&&v(o,i,n[i]);if(j)for(var i of j(n))$.call(n,i)&&v(o,i,n[i]);return o};import{u as D,k as A,r as m,e as k,d as B,j as t}from"./main-149.js";import{$ as W,i as z,h as G,c as H,e as O,j as w,E as J,k as K,_ as c,q as Q,D as V,N as y,L as X,s as Y}from"./bi.738.82.js";import{u as F,U as Z,C as ee,c as te}from"./bi.729.743.js";import{C as U}from"./bi.966.701.js";import"./bi.653.689.js";import"./bi.96.690.js";function de({allIntegURL:o}){var _,b;const n=D(),{formID:i}=A(),[C,d]=m.useState({show:!1}),[E,N]=m.useState([]),[f,I]=m.useState(!1),[g,L]=k(W),p=B(z),[e,u]=k(G);m.useEffect(()=>{var l,r;const a=h({},e);H({},"role/list",null,"GET").then(s=>{s!=null&&s.success&&s!==void 0&&N(Object.values(s==null?void 0:s.data))}),(r=(l=a==null?void 0:a.user_map)==null?void 0:l[0])!=null&&r.userField||(a.user_map=F.filter(s=>s.required).map(s=>({formField:"",userField:s.key,required:s.required}))),u(a)},[]);const R=()=>{if(!e.action_type){d({show:!0,msg:c("Please select action type","bit-integrations")});return}if(!e.user_role&&e.action_type!=="updated_user"){d({show:!0,msg:c("User Role can't be empty","bit-integrations")});return}if(!te(e)&&e.action_type!=="updated_user"){d({show:!0,msg:c("Please map mandatory fields","bit-integrations")});return}Y({flow:g,setFlow:L,allIntegURL:o,conf:e,navigate:n,edit:1,setIsLoading:I,setSnackbar:d})},S=(a,l)=>{const r=h({},e);l?r.condition.action_behavior=a:r.condition.action_behavior="",u(r)},x=a=>{const l=h({},e),{name:r,value:s}=a.target;a.target.checked&&(l[r]=s),u(h({},l))},q=`
  <ul>
  <li>The user must be logged in when updating profile</li>
  <li>The user cannot change the value of the username field when updating the user profile.</li>
     
  </ul>`,M=`
  <ul>
  <li>If the Username and Password fields are blank then the user will take the value of the email field as the field and the password will be auto-generated.</li>
     
  </ul>`;return t.jsxs("div",{children:[t.jsx(O,{snack:C,setSnackbar:d}),t.jsx("br",{}),!w(g.triggered_entity)&&t.jsx(J,{setSnackbar:d}),w(g.triggered_entity)&&t.jsx(K,{setSnackbar:d}),t.jsx("div",{className:"font-w-m mt-3",children:c("Action type","bit-integrations")}),t.jsxs("div",{children:[t.jsx(U,{radio:!0,name:"action_type",onChange:x,checked:(e==null?void 0:e.action_type)==="new_user",value:"new_user",title:c("New User Create","bit-integrations")}),t.jsx(U,{radio:!0,name:"action_type",onChange:x,checked:(e==null?void 0:e.action_type)==="updated_user",value:"updated_user",title:c("Updated User","bit-integrations")})]}),t.jsx("div",{children:t.jsx(Z,{formFields:p,formID:i,userConf:e,setUserConf:u,roles:E,userFields:F})}),t.jsxs("div",{children:[t.jsx(ee,{formFields:p,formID:i,userConf:e,setUserConf:u}),t.jsx("br",{})]}),(e==null?void 0:e.condition)&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flx",children:t.jsx(Q,{onChange:a=>S(a.target.value,a.target.checked),checked:((_=e==null?void 0:e.condition)==null?void 0:_.action_behavior)==="cond",className:"wdt-200 mt-4 mr-2",value:"cond",title:c("Conditional Logics","bit_integration")})}),t.jsx("br",{}),((b=e==null?void 0:e.condition)==null?void 0:b.action_behavior)==="cond"&&t.jsx(V,{formFields:p,dataConf:e,setDataConf:u})]}),(e==null?void 0:e.action_type)==="updated_user"?t.jsx(y,{note:q}):t.jsx(y,{note:M}),t.jsxs("button",{className:"btn f-left btcd-btn-lg green sh-sm flx",type:"button",onClick:R,disabled:f,children:[c("Update","bit-integrations"),f&&t.jsx(X,{size:20,clr:"#022217",className:"ml-2"})]})]})}export{de as default};
