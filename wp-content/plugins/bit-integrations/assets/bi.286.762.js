var I=Object.defineProperty,w=Object.defineProperties;var S=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var m=(e,a,t)=>a in e?I(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,s=(e,a)=>{for(var t in a||(a={}))F.call(a,t)&&m(e,t,a[t]);if(b)for(var t of b(a))k.call(a,t)&&m(e,t,a[t]);return e},p=(e,a)=>w(e,S(a));import{_ as c,c as _}from"./bi.738.82.js";const R=(e,a,t,d,n,o,l,i,u)=>{let r=s({},a);if(l){const g=s({},i);g[e.target.name]="",u(s({},g))}r[e.target.name]=e.target.value,t(s({},r))},v=(e,a,t,d,n,o)=>{if(!e.clientId||!e.clientSecret){t({clientId:e.clientId?"":c("Client ID cann't be empty","bit-integrations"),clientSecret:e.clientSecret?"":c("Secret key cann't be empty","bit-integrations")});return}n(!0);const l=`https://accounts.infusionsoft.com/app/oauth/authorize?scope=full&access_type=offline&prompt=consent&response_type=code&state=${encodeURIComponent(window.location.href)}/redirect&redirect_uri=${encodeURIComponent(`${btcbi.api.base}/redirect`)}&client_id=${e.clientId}`,i=window.open(l,"keap","width=400,height=609,toolbar=off"),u=setInterval(()=>{if(i.closed){clearInterval(u);let r={},g=!1;const f=localStorage.getItem("__keap");if(f&&(g=!0,r=JSON.parse(f),localStorage.removeItem("__keap")),!r.code||r.error||!r||!g){const h=r.error?`Cause: ${r.error}`:"";o({show:!0,msg:`${c("Authorization failed","bit-integrations")} ${h}. ${c("please try again","bit-integrations")}`}),n(!1)}else{const h=s({},e);h.accountServer=r["accounts-server"],y(r,h,a,d,n,o)}}},500)},y=(e,a,t,d,n,o)=>{const l=s({},e);l.clientId=a.clientId,l.clientSecret=a.clientSecret,l.redirectURI=`${btcbi.api.base}/redirect`,_(l,"keap_generate_token").then(i=>i).then(i=>{if(i&&i.success){const u=s({},a);u.tokenDetails=i.data,t(u),d(!0),o({show:!0,msg:c("Authorized Successfully","bit-integrations")})}else i&&i.data&&i.data.data||!i.success&&typeof i.data=="string"?o({show:!0,msg:`${c("Authorization failed Cause:","bit-integrations")}${i.data.data||i.data}. ${c("please try again","bit-integrations")}`}):o({show:!0,msg:c("Authorization failed. please try again","bit-integrations")});n(!1)})},z=e=>!((e.field_map?e.field_map.filter(t=>!t.formField&&!t.keapField):[]).length>0),A=e=>{const a=e==null?void 0:e.contactFields.filter(t=>t.required===!0);return a.length>0?a.map(t=>({formField:"",keapField:t.key})):[{formField:"",keapField:""}]},D=(e,a,t)=>{t(p(s({},t),{tags:!0}));const d={clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails};_(d,"keap_fetch_all_tags").then(n=>{if(n&&n.success){const o=s({},e);n.data&&(o.tags=n.data),a(o),t(!1),setSnackbar({show:!0,msg:c("Tag Fetched Successfully","bit-integrations")});return}t(p(s({},t),{tags:!1})),setSnackbar({show:!0,msg:c("Tag Couldn't Fetched Successfully","bit-integrations")})})};export{A as a,v as b,z as c,D as g,R as h};
