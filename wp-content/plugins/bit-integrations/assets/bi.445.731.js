var F=Object.defineProperty;var N=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var j=(e,s,a)=>s in e?F(e,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[s]=a,u=(e,s)=>{for(var a in s||(s={}))E.call(s,a)&&j(e,a,s[a]);if(N)for(var a of N(s))S.call(s,a)&&j(e,a,s[a]);return e};import{j as l,L as k}from"./main-149.js";import{B as x,c as w,d as A,_ as h,p as y,N as L}from"./bi.738.82.js";const O=(e,s,a,n,d)=>{let r=x(s);const{name:t,value:b}=e.target;switch(r[t]=b,t){case"module":r=P(r,a,n,d);break}a(r)},P=(e,s,a,n)=>{var r,t;let d=x(e);return d.field_map=[],(t=(r=d==null?void 0:d.default)==null?void 0:r.fields)!=null&&t[e.module]?d=R(d):refreshFields(d,s,a,n),d},_=(e,s,a,n=null)=>{a(!0);const r=w(null,"tutor_all_course",{type:n},"GET").then(t=>{if(t&&t.success){const b=u({},e);return b.default||(b.default={}),b.default.courses=t.data,s(u({},b)),a(!1),"Courses fetched successfully"}return a(!1),"Courses fetch failed. please try again"});A.promise(r,{success:t=>t,error:h("Error Occurred","bit-integrations"),loading:h("Loading Courses...")})},v=(e,s,a)=>{a(!0);const n=w(null,"tutor_all_lesson","","GET").then(d=>{if(d&&d.success){const r=u({},e);return r.default||(r.default={}),r.default.lessons=d.data,s(u({},r)),a(!1),"Lessons fetched successfully"}return a(!1),"Lessons fetch failed, please try again..."});A.promise(n,{success:d=>d,error:h("Error Occurred","bit-integrations"),loading:h("Loading Lessons...")})},R=e=>{const s=x(e);return s.default.fields[s.module].required.forEach(a=>{s.field_map.find(n=>n.wcField===a)||s.field_map.unshift({formField:"",wcField:a,required:!0})}),s.field_map.length||(s.field_map=[{formField:"",wcField:""}]),s};function T({tutorlmsConf:e,setTutorlmsConf:s,isLoading:a,setIsLoading:n}){var b,o;const d=[{value:"enroll-course",label:"Enroll the user in a course"},{value:"unenroll-course",label:"Unenroll user from a course"},{value:"complete-course",label:"Mark a course complete for the user"},{value:"complete-lesson",label:"Mark a lesson complete for the user"},{value:"reset-course",label:"Reset the user progress in a course"}],r=i=>{const c=u({},e),{name:p,value:g}=i.target;i.target.value!==""?c[p]=g:delete c[p],p==="actionName"?(c!=null&&c.selectedCourse&&delete c.selectedCourse,c!=null&&c.selectedLesson&&delete c.selectedLesson,c!=null&&c.selectedAllCourse&&delete c.selectedAllCourse,s(u({},c)),g==="enroll-course"||g==="unenroll-course"||g==="complete-course"||g==="reset-course"?_(c,s,n,g):g==="complete-lesson"&&v(c,s,n)):s(u({},c))},t=(i,c)=>{const p=u({},e);i?(c==="selectedCourse"&&i.includes("all-course")&&(p.selectedAllCourse=p.default.courses),p[c]=i?i.split(","):[]):p!=null&&p.selectedAllCourse&&delete p.selectedAllCourse,s(u({},p))};return l.jsxs(l.Fragment,{children:[l.jsx("br",{}),l.jsxs("div",{className:"flx",children:[l.jsx("b",{className:"wdt-200 d-in-b",children:h("Action:","bit-integrations")}),l.jsxs("select",{onChange:r,name:"actionName",value:e==null?void 0:e.actionName,className:"btcd-paper-inp w-5",children:[l.jsx("option",{value:"",children:h("Select Action","bit-integrations")}),d.map(({label:i,value:c})=>l.jsx("option",{value:c,children:i},i))]})]}),l.jsx("br",{}),((e==null?void 0:e.actionName)==="enroll-course"||(e==null?void 0:e.actionName)==="unenroll-course"||(e==null?void 0:e.actionName)==="complete-course"||(e==null?void 0:e.actionName)==="reset-course")&&l.jsxs("div",{className:"flx",children:[l.jsx("b",{className:"wdt-200 d-in-b",children:h("Select Course: ","bit-integrations")}),l.jsx(y,{defaultValue:e==null?void 0:e.selectedCourse,className:"btcd-paper-drpdwn w-5",options:((b=e==null?void 0:e.default)==null?void 0:b.courses)&&e.default.courses.map(i=>({label:i.courseTitle,value:i.courseId.toString()})),onChange:i=>t(i,"selectedCourse"),singleSelect:(e==null?void 0:e.actionName)==="complete-course"||(e==null?void 0:e.actionName)==="reset-course"}),l.jsx("button",{onClick:()=>_(e,s,n,e==null?void 0:e.actionName),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${h("Refresh Courses","bit-integrations")}'`},type:"button",disabled:a,children:"↻"})]}),(e==null?void 0:e.actionName)==="complete-lesson"&&l.jsxs("div",{className:"flx",children:[l.jsx("b",{className:"wdt-200 d-in-b",children:h("Select Lessons: ","bit-integrations")}),l.jsx(y,{defaultValue:e==null?void 0:e.selectedLesson,className:"btcd-paper-drpdwn w-5",options:((o=e==null?void 0:e.default)==null?void 0:o.lessons)&&e.default.lessons.map(i=>({label:i.lessonTitle,value:i.lessonId.toString()})),onChange:i=>t(i,"selectedLesson"),singleSelect:!0}),l.jsx("button",{onClick:()=>v(e,s,n),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${h("Refresh Courses","bit-integrations")}'`},type:"button",disabled:a,children:"↻"})]}),l.jsx("br",{}),l.jsx("br",{}),a&&l.jsx(k,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),l.jsx(L,{note:"This integration will only work for logged-in users."})]})}export{T,O as h};
