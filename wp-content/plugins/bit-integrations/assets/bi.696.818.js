var A=Object.defineProperty;var v=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var N=(s,n,e)=>n in s?A(s,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[n]=e,u=(s,n)=>{for(var e in n||(n={}))q.call(n,e)&&N(s,e,n[e]);if(v)for(var e of v(n))G.call(n,e)&&N(s,e,n[e]);return s};import{r as j,j as t,L as k,d as I}from"./main-149.js";import{q as F,_ as c,f as T,p as $,m as O,n as V,o as M}from"./bi.738.82.js";import{g as w,a as E,m as z}from"./bi.479.817.js";import{T as P}from"./bi.653.689.js";function B({mailRelayConf:s,setMailRelayConf:n,loading:e,setLoading:i}){var x,p;const[a,o]=j.useState({show:!1,action:()=>{}}),b=(d,l)=>{var h;const r=u({},s);l==="group"&&((h=d.target)!=null&&h.checked?(w(s,n,i),r.actions.groups=!0):(o({show:!1}),delete r.actions.groups),o({show:"group"})),l==="update"&&(d.target.checked?r.actions.update=!0:delete r.actions.update),l==="doubleOptIn"&&(d.target.checked?r.actions.doubleOptIn=!0:delete r.actions.doubleOptIn),n(u({},r))},g=()=>{o({show:!1})},m=d=>{const l=u({},s);l.selectedGroups=d,n(u({},l))};return t.jsxs("div",{className:"pos-rel d-flx w-8",children:[t.jsx(F,{checked:(s==null?void 0:s.selectedGroups.length)||!1,onChange:d=>b(d,"group"),className:"wdt-200 mt-4 mr-2",value:"group",title:c("Add Groups","bit - integrations"),subTitle:c("Add Groups")}),t.jsx(F,{checked:((x=s.actions)==null?void 0:x.update)||!1,onChange:d=>b(d,"update"),className:"wdt-200 mt-4 mr-2",value:"update_subscriber",title:c("Update subscriber","bit-integrations"),subTitle:c("Override the existing subscriber info by responses.","bit-integrations")}),t.jsxs(T,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:c("Ok","bit-integrations"),show:a.show==="group",close:g,action:g,title:c("Groups","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsx("div",{className:"mt-2",children:c("Select groups","bit-integrations")}),e.groups?t.jsx(k,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):t.jsxs("div",{className:"flx flx-between mt-2",children:[t.jsx($,{options:(p=s==null?void 0:s.groups)==null?void 0:p.map(d=>({label:d.name,value:d.id})),className:"msl-wrp-options",defaultValue:s==null?void 0:s.selectedGroups,onChange:d=>m(d)}),t.jsx("button",{onClick:()=>w(s,n,i),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${c("Refresh Groups","bit-integrations")}'`},type:"button",children:"↻"})]})]})]})}const S=(s,n,e)=>{const i=u({},n);i.field_map.splice(s,0,{}),e(u({},i))},H=(s,n,e)=>{const i=u({},n);i.field_map.length>1&&i.field_map.splice(s,1),e(u({},i))},_=(s,n,e,i)=>{const a=u({},e);a.field_map[n][s.target.name]=s.target.value,s.target.value==="custom"&&(a.field_map[n].customValue=""),i(u({},a))};function L({i:s,formFields:n,field:e,mailRelayConf:i,setMailRelayConf:a}){var d,l;const o=(i==null?void 0:i.staticFields.filter(r=>r.required===!0))||[],b=(i==null?void 0:i.customFields.filter(r=>r.required===!1))||[],m=[...(i==null?void 0:i.staticFields.filter(r=>r.required===!1))||[],...b];if(((d=i==null?void 0:i.field_map)==null?void 0:d.length)===1&&e.mailRelayFormField===""){const r=u({},i),h=E(r);r.field_map=h,a(r)}const x=I(O),{isPro:p}=x;return t.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:t.jsxs("div",{className:"pos-rel flx",children:[t.jsxs("div",{className:"flx integ-fld-wrp",children:[t.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:e.formField||"",onChange:r=>_(r,s,i,a),children:[t.jsx("option",{value:"",children:c("Select Field","bit-integrations")}),t.jsx("optgroup",{label:"Form Fields",children:n==null?void 0:n.map(r=>t.jsx("option",{value:r.name,children:r.label},`ff-rm-${r.name}`))}),t.jsx("option",{value:"custom",children:c("Custom...","bit-integrations")}),t.jsx("optgroup",{label:`General Smart Codes ${p?"":"(PRO)"}`,children:p&&((l=V)==null?void 0:l.map(r=>t.jsx("option",{value:r.name,children:r.label},`ff-rm-${r.name}`)))})]}),e.formField==="custom"&&t.jsx(P,{onChange:r=>M(r,s,i,a),label:c("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:e.customValue,placeholder:c("Custom Value","bit-integrations"),formFields:n}),t.jsxs("select",{className:"btcd-paper-inp",disabled:s<o.length,name:"mailRelayFormField",value:s<o?o[s].label||"":e.mailRelayFormField||"",onChange:r=>_(r,s,i,a),children:[t.jsx("option",{value:"",children:c("Select Field","bit-integrations")}),s<o.length?t.jsx("option",{value:o[s].key,children:o[s].label},o[s].key):m.map(({key:r,label:h})=>t.jsx("option",{value:r,children:h},r))]})]}),s>=o.length&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>S(s,i,a),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),t.jsx("button",{onClick:()=>H(s,i,a),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:t.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function W({formFields:s,handleInput:n,mailRelayConf:e,setMailRelayConf:i,loading:a,setLoading:o,setSnackbar:b}){const[g,m]=j.useState({name:"",auth_token:""}),[x,p]=j.useState(!1);return t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsx("b",{className:"wdt-200 d-in-b",children:c("Subscriber Status:","bit-integrations")}),t.jsxs("select",{onChange:n,name:"status",value:e.status,className:"btcd-paper-inp w-5",children:[t.jsx("option",{value:"",children:c("Select subscriber status","bit-integrations")}),t.jsx("option",{value:"active",children:c("Active","bit-integrations")}),t.jsx("option",{value:"inactive",children:c("Inactive","bit-integrations")})]}),a.customFields&&t.jsx(k,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),e.status&&t.jsxs("div",{children:[t.jsx("br",{}),t.jsx("div",{className:"mt-5",children:t.jsxs("b",{className:"wdt-100",children:[c("Field Map","bit-integrations"),t.jsx("button",{onClick:()=>z(e,i,m,p,a,o,"refreshCustomFields"),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${c("Refresh custom fields","bit-integrations")}'`},type:"button",disabled:a.customFields,children:"↻"})]})}),t.jsx("br",{}),t.jsx("div",{className:"btcd-hr mt-1"}),t.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:c("Form Fields","bit-integrations")})}),t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:c("MailRelay Fields","bit-integrations")})})]}),e==null?void 0:e.field_map.map((d,l)=>t.jsx(L,{i:l,field:d,mailRelayConf:e,formFields:s,setMailRelayConf:i,setSnackbar:b},`rp-m-${l+9}`)),t.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:t.jsx("button",{onClick:()=>S(e.field_map.length,e,i),className:"icn-btn sh-sm",type:"button",children:"+"})}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("div",{className:"mt-4",children:t.jsx("b",{className:"wdt-100",children:c("Actions","bit-integrations")})}),t.jsx("div",{className:"btcd-hr mt-1"}),t.jsx(B,{mailRelayConf:e,setMailRelayConf:i,formFields:s,loading:a,setLoading:o})]})]})}export{W as M};
