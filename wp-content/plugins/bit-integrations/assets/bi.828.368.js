var W=Object.defineProperty;var C=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var I=(o,c,r)=>c in o?W(o,c,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[c]=r,f=(o,c)=>{for(var r in c||(c={}))G.call(c,r)&&I(o,r,c[r]);if(C)for(var r of C(c))H.call(c,r)&&I(o,r,c[r]);return o};import{r as u,u as J,k as K,j as e}from"./main-149.js";import{c as _,e as Q,_ as i,U as N,I as V,F as X}from"./bi.738.82.js";import{S as Y}from"./bi.384.918.js";import{r as Z,F as ee,a as te,C as se,c as ie,b as ae,d as ne}from"./bi.856.744.js";import{p as L}from"./bi.195.718.js";import{T as q,t as le}from"./bi.452.742.js";import"./bi.653.689.js";import"./bi.96.690.js";function xe({formFields:o,setFlow:c,flow:r,allIntegURL:y}){var F;const[j,M]=u.useState([]),[g,S]=u.useState([]),k=J(),{formID:D}=K(),[w,v]=u.useState(!1),[b,A]=u.useState(1),[E,m]=u.useState({show:!1}),[T,$]=u.useState({fields:[],files:[]}),[z,O]=u.useState({fields:[],files:[]}),{postCreation:n}=le,[a,h]=u.useState({name:"Post Creation",type:"Post Creation",post_map:[{post_author:"logged_in_user"}],acf_map:[{}],acf_file_map:[{}],metabox_map:[{}],metabox_file_map:[{}]}),x=(t,s)=>{const l=f({},a);l[t]=s,h(l)};u.useEffect(()=>{_({},"user/list").then(s=>{const{data:l}=s;M(l)}),_({},"post-types/list").then(s=>{const{data:l}=s;S(l)});const t=f({},a);t.post_map=L.filter(s=>s.required).map(s=>({formField:"",postField:s.key,required:s.required})),h(t)},[]);const U=(t,s)=>{const l=f({},a);l[t]=s,_({post_type:s},"customfield/list").then(R=>{const{data:d}=R;$({fields:d.acf_fields,files:d.acf_files}),O({fields:d.mb_fields,files:d.mb_files}),d!=null&&d.acf_fields&&(l.acf_map=d.acf_fields.filter(p=>p.required).map(p=>({formField:"",acfField:p.key,required:p.required})),l.acf_map.length<1&&(l.acf_map=[{}])),d!=null&&d.mb_fields&&(l.metabox_map=d.mb_fields.filter(p=>p.required).map(p=>({formField:"",metaboxField:p.key,required:p.required})),l.metabox_map.length<1&&(l.metabox_map=[{}]))}),h(l)},P=t=>{if(setTimeout(()=>{document.getElementById("btcd-settings-wrp").scrollTop=0},300),!ie(a)){m({show:!0,msg:i("Please map mandatory fields","bit-integrations")});return}if(!a.post_type){m({show:!0,msg:i("Post Type cann't be empty","bit-integrations")});return}if(!a.post_status){m({show:!0,msg:i("Post Status cann't be empty","bit-integrations")});return}if(t===3){if(!ae(a)){m({show:!0,msg:i("Please map mandatory fields","bit-integrations")});return}if(!ne(a)){m({show:!0,msg:i("Please map mandatory fields","bit-integrations")});return}}A(t)},B=()=>{v(!0),X(r,c,y,a,k,"","",v).then(s=>{var l;s.success?(m({show:!0,msg:(l=s.data)==null?void 0:l.msg}),k(y)):m({show:!0,msg:s.data||s})})};return e.jsxs("div",{children:[e.jsx(Q,{snack:E,setSnackbar:m}),(n==null?void 0:n.youTubeLink)&&e.jsx(q,{title:n==null?void 0:n.title,youTubeLink:n==null?void 0:n.youTubeLink}),(n==null?void 0:n.docLink)&&e.jsx(q,{title:n==null?void 0:n.title,docLink:n==null?void 0:n.docLink}),e.jsx("div",{className:"txt-center mt-2",children:e.jsx(Y,{step:3,active:b})}),e.jsxs("div",{className:"btcd-stp-page",style:{width:b===1&&900,height:b===1&&"auto"},children:[e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:i("Integration Name ","bit-integrations")})}),e.jsx("input",{className:"btcd-paper-inp w-5 mt-1",onChange:t=>x(t.target.name,t.target.value),name:"name",value:a.name,type:"text",placeholder:i("Integration Name...","bit-integrations")}),e.jsxs("div",{className:"mt-3 flx",children:[e.jsx("b",{children:i("Post Type","bit-integrations")}),e.jsx(N,{width:250,icnSize:17,className:"ml-2",children:e.jsxs("div",{className:"txt-body",children:["Select one of the defined WordPress post types Or custom post types for the post.",e.jsx("br",{})]})})]}),e.jsxs("div",{children:[e.jsxs("select",{name:"post_type",onChange:t=>U(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:"Select Post Type"}),g==null?void 0:g.map((t,s)=>e.jsx("option",{value:t==null?void 0:t.id,children:t==null?void 0:t.title},`acf-${s*2}`))]}),e.jsx("button",{onClick:()=>Z(g,S),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${i("Refresh Post Types","bit-integrations")}'`},type:"button",children:"â†»"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("b",{children:i("Post Status","bit-integrations")}),e.jsx(N,{width:250,icnSize:17,className:"ml-2",children:e.jsxs("div",{className:"txt-body",children:["Select the status for the post. If published status is selected and the post date is in the future, it will automatically be changed to scheduled",e.jsx("br",{})]})})]}),e.jsxs("select",{name:"post_status",onChange:t=>x(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-2",children:[e.jsx("option",{disabled:!0,selected:!0,children:i("Select Status","bit-integrations")}),e.jsx("option",{value:"publish",children:"Publish"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"auto-draft",children:"Auto-Draft"}),e.jsx("option",{value:"private",children:"Private"}),e.jsx("option",{value:"pending",children:"Pending"})]}),e.jsxs("div",{className:"mt-3 flx",children:[e.jsx("b",{children:i("Author","bit-integrations")}),e.jsx(N,{width:250,icnSize:17,className:"ml-2",children:e.jsxs("div",{className:"txt-body",children:["Select the user to be assigned to the post.",e.jsx("br",{})]})})]}),e.jsx("div",{children:e.jsxs("select",{name:"post_author",onChange:t=>x(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-2",children:[e.jsx("option",{disabled:!0,selected:!0,children:i("Select Author","bit-integrations")}),e.jsx("option",{value:"logged_in_user",children:"Logged In User"}),j==null?void 0:j.map((t,s)=>e.jsx("option",{value:t.ID,children:t.display_name},`acf-${s*2}`))]})}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:i("Comment Status","bit-integrations")})}),e.jsxs("select",{name:"comment_status",onChange:t=>x(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-2",children:[e.jsx("option",{disabled:!0,selected:!0,children:i("Select Status","bit-integrations")}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:i("Post Field Mapping","bit-integrations")})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:i("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:i("Post Fields","bit-integrations")})})]})]}),(F=a==null?void 0:a.post_map)==null?void 0:F.map((t,s)=>e.jsx(ee,{i:s,type:"post",field:t,formFields:o,postConf:a,setPostConf:h,customFields:L},`analytics-m-${s+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>te("post_map",a.post_map.length,a,h),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsxs("button",{onClick:()=>P(2),className:"btn f-right btcd-btn-lg green sh-sm flx",type:"button",children:[i("Next","bit-integrations"),e.jsx("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]}),e.jsxs("div",{className:"btcd-stp-page",style:f({},b===2&&{width:900,height:"auto",overflow:"visible"}),children:[e.jsx(se,{formID:D,formFields:o,handleInput:t=>x(t,a),postConf:a,setPostConf:h,isLoading:w,setIsLoading:v,setSnackbar:m,acfFields:T,mbFields:z}),e.jsxs("button",{onClick:()=>P(3),className:"btn f-right btcd-btn-lg green sh-sm flx",type:"button",children:[i("Next","bit-integrations"),e.jsx("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]}),e.jsx(V,{step:b,saveConfig:()=>B(),isLoading:w,dataConf:a,setDataConf:h,formFields:o})]})}export{xe as default};
