var V=Object.defineProperty;var A=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var P=(e,i,a)=>i in e?V(e,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[i]=a,p=(e,i)=>{for(var a in i||(i={}))U.call(i,a)&&P(e,a,i[a]);if(A)for(var a of A(i))E.call(i,a)&&P(e,a,i[a]);return e};import{r as H,j as t,L as F,d as K}from"./main-149.js";import{q as T,_ as n,f as x,p as I,H as B,m as G,n as z}from"./bi.738.82.js";import{g as $,a as m,b as D}from"./bi.850.905.js";function J({moxiecrmConf:e,setMoxieCRMConf:i,loading:a,setLoading:l}){var b,o,N,v;const[d,c]=H.useState({show:!1,action:()=>{}}),r=(s,g)=>{var w,y,S,_,k;const u=p({},e);g==="opportunity"?(w=s.target)!=null&&w.checked?(getAllOpportunities(e,i,l),u.actions.opportunity=!0):(c({show:!1}),delete u.actions.opportunity):g==="client"?(y=s.target)!=null&&y.checked?($(e,i,l),u.actions.client=!0):(c({show:!1}),delete u.actions.client):g==="pipelineStage"?(S=s.target)!=null&&S.checked?(m(e,i,l),u.actions.pipelineStage=!0):(c({show:!1}),delete u.actions.pipelineStage):g==="followUp"?(_=s.target)!=null&&_.checked?u.actions.followUp=!0:(c({show:!1}),delete u.actions.followUp):g==="opportunityType"&&((k=s.target)!=null&&k.checked?u.actions.opportunityType=!0:(c({show:!1}),delete u.actions.opportunityType)),c({show:g}),i(p({},u))},h=()=>{c({show:!1})},j=(s,g)=>{const u=p({},e);u[g]=s,i(p({},u))};return t.jsxs("div",{className:"pos-rel d-flx flx-wrp",children:[(e.actionName==="contact"||e.actionName==="opportunity")&&t.jsx(T,{checked:((b=e==null?void 0:e.selectedClient)==null?void 0:b.length)||!1,onChange:s=>r(s,"client"),className:"wdt-200 mt-4 mr-2",value:"client",title:n("Add Client","bit - integrations"),subTitle:n("Add an client")}),e.actionName==="opportunity"&&t.jsx(T,{checked:((o=e==null?void 0:e.selectedPipelineStage)==null?void 0:o.length)||!1,onChange:s=>r(s,"pipelineStage"),className:"wdt-200 mt-4 mr-2",value:"pipelineStage",title:n("Add PipelineStage","bit - integrations"),subTitle:n("Add a pipelineStage")}),t.jsxs(x,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:n("Ok","bit-integrations"),show:d.show==="client",close:h,action:h,title:n("Clients","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsx("div",{className:"mt-2",children:n("Select Client","bit-integrations")}),a.clients?t.jsx(F,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):t.jsxs("div",{className:"flx flx-between mt-2",children:[t.jsx(I,{options:(N=e==null?void 0:e.clients)==null?void 0:N.map(s=>({label:s.name,value:s.name})),className:"msl-wrp-options",defaultValue:e==null?void 0:e.selectedClient,onChange:s=>j(s,"selectedClient"),singleSelect:!0}),t.jsx("button",{onClick:()=>$(e,i,l),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${n("Refresh Clients","bit-integrations")}'`},type:"button",children:"↻"})]})]}),t.jsxs(x,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:n("Ok","bit-integrations"),show:d.show==="pipelineStage",close:h,action:h,title:n("PipelineStages","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsx("div",{className:"mt-2",children:n("Select PipelineStage","bit-integrations")}),a.pipelineStages?t.jsx(F,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):t.jsxs("div",{className:"flx flx-between mt-2",children:[t.jsx(I,{options:(v=e==null?void 0:e.pipelineStages)==null?void 0:v.map(s=>({label:s.name,value:s.name})),className:"msl-wrp-options",defaultValue:e==null?void 0:e.selectedPipelineStage,onChange:s=>j(s,"selectedPipelineStage"),singleSelect:!0}),t.jsx("button",{onClick:()=>m(e,i,l),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${n("Refresh PipelineStages","bit-integrations")}'`},type:"button",children:"↻"})]})]})]})}const O=(e,i,a)=>{const l=p({},i);l.field_map.splice(e,0,{}),a(p({},l))},Q=(e,i,a)=>{const l=p({},i);l.field_map.length>1&&l.field_map.splice(e,1),a(p({},l))},q=(e,i,a,l)=>{const d=p({},a);d.field_map[i][e.target.name]=e.target.value,e.target.value==="custom"&&(d.field_map[i].customValue=""),e.target.value==="customFieldKey"&&(d.field_map[i].customFieldKey=""),l(p({},d))},W=(e,i,a,l,d)=>{const c=p({},a);c.field_map[i][d]=e.target.value,l(p({},c))};function X({field:e,index:i,conf:a,setConf:l,fieldValue:d,fieldLabel:c,className:r}){return t.jsx(B,{onChange:h=>W(h,i,a,l,d),label:n(c,"bit-integrations"),className:r,type:"text",value:e[d],placeholder:n(c,"bit-integrations")})}function Y({i:e,formFields:i,field:a,moxiecrmConf:l,setMoxieCRMConf:d}){var N,v;let c=[];l.actionName==="client"?c=l==null?void 0:l.clientFields:l.actionName==="contact"?c=l==null?void 0:l.contactFields:l.actionName==="opportunity"&&(c=l==null?void 0:l.opportunityFields);const r=c.filter(s=>s.required===!0)||[],h=c.filter(s=>s.required===!1)||[],j=l.customFields?[...h,...l==null?void 0:l.customFields]:h;if(((N=l==null?void 0:l.field_map)==null?void 0:N.length)===1&&a.moxiecrmFormField===""){const s=p({},l),g=D(s);s.field_map=g,d(s)}const b=K(G),{isPro:o}=b;return t.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:t.jsxs("div",{className:"pos-rel flx",children:[t.jsxs("div",{className:"flx integ-fld-wrp",children:[t.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:a.formField||"",onChange:s=>q(s,e,l,d),children:[t.jsx("option",{value:"",children:n("Select Field","bit-integrations")}),t.jsx("optgroup",{label:"Form Fields",children:i==null?void 0:i.map(s=>t.jsx("option",{value:s.name,children:s.label},`ff-rm-${s.name}`))}),t.jsx("option",{value:"custom",children:n("Custom...","bit-integrations")}),t.jsx("optgroup",{label:`General Smart Codes ${o?"":"(PRO)"}`,children:o&&((v=z)==null?void 0:v.map(s=>t.jsx("option",{value:s.name,children:s.label},`ff-rm-${s.name}`)))})]}),a.formField==="custom"&&t.jsx(X,{field:a,index:e,conf:l,setConf:d,fieldValue:"customValue",fieldLabel:"Custom Value",className:"mr-2"}),t.jsxs("select",{className:"btcd-paper-inp",disabled:e<r.length,name:"moxiecrmFormField",value:e<r?r[e].label||"":a.moxiecrmFormField||"",onChange:s=>q(s,e,l,d),children:[t.jsx("option",{value:"",children:n("Select Field","bit-integrations")}),e<r.length?t.jsx("option",{value:r[e].key,children:r[e].label},r[e].key):j.map(({key:s,label:g})=>t.jsx("option",{value:s,children:g},s))]})]}),e>=r.length&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>O(e,l,d),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),t.jsx("button",{onClick:()=>Q(e,l,d),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:t.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function f({formFields:e,handleInput:i,moxiecrmConf:a,setMoxieCRMConf:l,loading:d,setLoading:c,setSnackbar:r}){const h=j=>{const b=p({},a);b.field_map=[{formField:"",moxiecrmFormField:""}];const{name:o}=j.target;j.target.value!==""?b[o]=j.target.value:delete b[o],l(p({},b))};return t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsx("b",{className:"wdt-200 d-in-b",children:n("Select Action:","bit-integrations")}),t.jsxs("select",{onChange:h,name:"actionName",value:a.actionName,className:"btcd-paper-inp w-5",children:[t.jsx("option",{value:"",children:n("Select an action","bit-integrations")}),t.jsx("option",{value:"client",children:n("Create Client","bit-integrations")}),t.jsx("option",{value:"contact",children:n("Create Contact","bit-integrations")}),t.jsx("option",{value:"opportunity",children:n("Create Opportunity","bit-integrations")})]}),a.actionName==="client"&&t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsx("br",{}),t.jsx("b",{className:"wdt-200 d-in-b",children:n("Select Record Type:","bit-integrations")}),t.jsxs("select",{onChange:h,name:"recordType",value:a.recordType,className:"btcd-paper-inp w-5",children:[t.jsx("option",{value:"Client",children:n("Client","bit-integrations")}),t.jsx("option",{value:"Prospect",children:n("Prospect","bit-integrations")})]})]}),d.customFields&&t.jsx(F,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),a.actionName&&t.jsxs("div",{children:[t.jsx("br",{}),t.jsx("div",{className:"mt-5",children:t.jsx("b",{className:"wdt-100",children:n("Field Map","bit-integrations")})}),t.jsx("br",{}),t.jsx("div",{className:"btcd-hr mt-1"}),t.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:n("Form Fields","bit-integrations")})}),t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:n("MoxieCRM Fields","bit-integrations")})})]}),a==null?void 0:a.field_map.map((j,b)=>t.jsx(Y,{i:b,field:j,moxiecrmConf:a,formFields:e,setMoxieCRMConf:l,setSnackbar:r},`rp-m-${b+9}`)),t.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:t.jsx("button",{onClick:()=>O(a.field_map.length,a,l),className:"icn-btn sh-sm",type:"button",children:"+"})}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("div",{className:"mt-4",children:t.jsx("b",{className:"wdt-100",children:n("Actions","bit-integrations")})}),t.jsx("div",{className:"btcd-hr mt-1"}),t.jsx(J,{moxiecrmConf:a,setMoxieCRMConf:l,formFields:e,loading:d,setLoading:c})]})]})}export{f as M};
