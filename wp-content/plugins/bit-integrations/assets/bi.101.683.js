var V=Object.defineProperty;var D=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var $=(e,s,l)=>s in e?V(e,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[s]=l,N=(e,s)=>{for(var l in s||(s={}))K.call(s,l)&&$(e,l,s[l]);if(D)for(var l of D(s))U.call(s,l)&&$(e,l,s[l]);return e};import{j as t,r as u,m as C,_ as Y,L as Z}from"./main-149.js";import{C as q,T as J,a as Q,b as X,u as tt,_ as o,S as A,c as k,d as p,e as et,f as st,g as nt,M as it}from"./bi.738.82.js";import{E as at}from"./bi.57.686.js";function ot({size:e=30,stroke:s=2}){return t.jsxs("svg",{width:e,height:e,viewBox:"0 0 30 30",children:[t.jsx("ellipse",{className:"svg-icn",strokeWidth:s,strokeMiterlimit:"10",cx:"15",cy:"15",rx:"11",ry:"11.09"}),t.jsx("ellipse",{className:"svg-icn",strokeWidth:2,strokeMiterlimit:"10",cx:"15",cy:"11",rx:"1",ry:"1"}),t.jsx("line",{className:"svg-icn",strokeWidth:s-.5,strokeLinecap:"round",strokeLinejoin:"round",x1:"15",y1:"18",x2:"15",y2:"21.72"})]})}function lt({size:e}){return t.jsxs("svg",{id:"Layer_1","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 215 215",children:[t.jsx("rect",{className:"cls-1",fill:"none",strokeWidth:"16",stroke:"currentColor",strokeMiterlimit:"10",x:"19.91",y:"20.9",width:"174",height:"174",rx:"85"}),t.jsx("path",{fill:"currentColor",className:"cls-2",stroke:"currentColor",strokeMiterlimit:"10",strokeWidth:"4",d:"M138.3,151.06,99.23,113.52a6,6,0,0,1-1.85-4.34V56.47a6,6,0,0,1,6-6h0a6,6,0,0,1,6,6v47.59a6,6,0,0,0,1.85,4.33l35.37,34a6,6,0,0,1,.17,8.51h0A6,6,0,0,1,138.3,151.06Z"})]})}function rt(e){const s=u.useRef(null),l=u.useRef(null),[h,c]=u.useState(!1),m=f=>{h&&s.current&&s.current.contains(f.target)&&c(!1),document.removeEventListener("click",m)};u.useEffect(()=>(l.current.parentNode.parentNode.parentNode.style.zIndex=h?"10":"auto",h||l.current.blur(),document.addEventListener("click",m),()=>{document.removeEventListener("click",m)}),[h]);const w=h?`${s.current.clientHeight}px`:"auto";return t.jsxs("div",{className:"btcd-menu",children:[t.jsx("button",{ref:l,className:"btcd-menu-btn btcd-mnu sh-sm",onClick:()=>c(f=>!f),"aria-label":"toggle menu",type:"button"}),t.jsxs("div",{ref:s,className:`btcd-menu-list ${h?"btcd-m-a":""}`,style:{height:w},children:[t.jsxs(C,{to:`/flow/action/info/${e.id}/${e.name}`,type:"button",className:"flx","aria-label":"actions",children:[t.jsx(ot,{size:16}),"  Info"]}),t.jsxs(C,{to:`/flow/action/log/${e.id}/${e.name}`,type:"button",className:"flx","aria-label":"actions",children:[t.jsx(lt,{size:16}),"  Timeline"]}),t.jsxs(C,{to:`/flow/action/edit/${e.id}`,type:"button",className:"flx","aria-label":"actions",children:[t.jsx(at,{size:16}),"  Edit"]}),e.isLicenseActive&&t.jsxs("button",{type:"button","aria-label":"actions",className:"flx",onClick:e.dup,children:[t.jsx(q,{size:16}),"  Clone"]}),t.jsxs("button",{type:"button","aria-label":"actions",className:"flx",onClick:e.del,children:[t.jsx(J,{size:16}),"  Delete"]})]})]})}function ct({show:e,setModal:s,md:l,lg:h,style:c,className:m,title:w,warning:f,hdrActn:i,children:j,data:I}){const y=v=>{v.target.classList.contains("btcd-modal-wrp")&&s(!1)};return t.jsx(Q,{in:e,timeout:500,classNames:"btc-mdl-trn",unmountOnExit:!0,children:t.jsx("div",{role:"button",tabIndex:0,onKeyPress:y,onClick:y,className:"btcd-modal-wrp flx",children:t.jsx("div",{className:`btcd-modal ${l?"btcd-m-md":""} ${h?"btcd-m-lg":""} ${m}`,style:c,children:t.jsxs("div",{className:"btcd-modal-content",children:[i,t.jsx("button",{onClick:()=>s(!1),className:"icn-btn btcd-mdl-close","aria-label":"modal-close",type:"button",children:t.jsx(X,{size:16,stroke:3})}),t.jsx("h2",{className:"btcd-mdl-title flx",style:{color:f?"red":""},children:w}),t.jsxs("div",{className:"d-flx flx-col",children:[t.jsxs("div",{className:"d-flx flx-col mt-3",children:[I>1&&t.jsx("small",{className:"btcd-buy-mdl-subtitle",style:{width:"100%",marginBottom:"10px",fontFamily:"dashicons"},children:"This notice is informing that starting from February 15, there will be a change in the free version of a service. Specifically, the free version will only allow for one integration, but all previous integrations will continue to work normally."}),t.jsxs("small",{className:"btcd-buy-mdl-subtitle",style:{width:"100%",fontFamily:"dashicons"},children:["You can make"," ",t.jsx("span",{style:{fontWeight:"bold",fontFamily:"dashicons"},children:"1 integration"})," ","in free version."]})]}),t.jsxs("div",{children:[t.jsx("small",{className:"btcd-buy-mdl-subtitle",style:{width:"100%",fontFamily:"dashicons"},children:"Get pro version to create unlimited integrations."}),t.jsx("a",{className:"btn ml-auto btcd-btn-lg sh-lm flx mt-3 blue blue-sh",href:"https://www.bitapps.pro/bit-integrations",target:"_blank",rel:"noreferrer",children:"Get Pro"})]})]}),!l&&t.jsx("div",{className:"btcd-mdl-div"}),j]})})})})}const dt=u.lazy(()=>Y(()=>import("./bi.776.685.js"),["./bi.776.685.js","./main-149.js","./bi.738.82.js","./App.css.382.922.css"],import.meta.url));function ut({isLicenseActive:e}){var W;const{data:s,isLoading:l,mutate:h}=tt({payload:{},action:"flow/list",method:"get"}),[c,m]=u.useState(!l&&s.success&&((W=s==null?void 0:s.data)!=null&&W.integrations)?s.data.integrations:[]),[w,f]=u.useState({show:!1}),[i,j]=u.useState({show:!1,btnTxt:""});u.useState({show:!1,msg:""});const[I,y]=u.useState({show:!1,msg:""}),[v,M]=u.useState({show:e===!0}),[_,T]=u.useState([{width:250,minWidth:80,Header:o("Trigger","bit-integrations"),accessor:"triggered_entity"},{width:250,minWidth:80,Header:o("Action Name","bit-integrations"),accessor:"name"},{width:200,minWidth:200,Header:o("Created At","bit-integrations"),accessor:"created_at"},{width:70,minWidth:60,Header:o("Status","bit-integrations"),accessor:"status",Cell:a=>t.jsx(A,{className:"flx",action:n=>E(n,a.row.original.id),checked:Number(a.row.original.status)===1})}]);u.useEffect(()=>{!l&&m(s.success?s.data.integrations:[])},[s]),u.useEffect(()=>{const a=_.filter(n=>n.accessor!=="t_action"&&n.accessor!=="status");a.push({width:70,minWidth:60,Header:o("Status","bit-integrations"),accessor:"status",Cell:n=>t.jsx(A,{className:"flx",action:d=>E(d,n.row.original.id),checked:Number(n.row.original.status)===1})}),a.push({sticky:"right",width:100,minWidth:60,Header:"Actions",accessor:"t_action",Cell:n=>t.jsx(rt,{isLicenseActive:e,id:n.row.original.id,name:n.row.original.name,index:n.row.id,del:()=>z(n.row.original.id,n.row.index),dup:()=>B(n.row.original.id,n.row.index)})}),T([...a])},[c]);const E=(a,n)=>{const d=a.target.checked,b=[...c],r=b.find(g=>g.id===n);r.status=d===!0?"1":"0",m(b),k({id:n,status:d},"flow/toggleStatus").then(g=>{p.success(o(g.data,"bit-integrations"))}).catch(()=>{p.error(o("Something went wrong","bit-integrations"))})},H=(a,n)=>{const d=[...c],b=k({id:a},"flow/delete").then(r=>r.success?(d.splice(n,1),h(d),m(d),"Integration deleted successfully"):r.data);p.promise(b,{success:r=>r,error:o("Error Occurred","bit-integrations"),loading:o("delete...")})},O=a=>{const n=k({id:a},"flow/clone").then(d=>{if(d.success){const b=d.data,r=[...c],x=r.find(G=>G.id===a),g={id:b.id,name:`duplicate of ${x.name}`,triggered_entity:x.triggered_entity,status:x.status,created_at:b.created_at};return r.push(g),m(r),"Integration clone successfully"}return d.data});p.promise(n,{success:d=>d,error:o("Error Occurred","bit-integrations"),loading:o("cloning...")})},F=u.useCallback(a=>{const n=[],d=[];for(let r=0;r<a.length;r+=1)n.push(a[r].id),d.push(a[r].original.id);const b=k({flowID:d},"flow/bulk-delete").then(r=>{if(r.success){const x=[...c];for(let g=n.length-1;g>=0;g-=1)x.splice(Number(n[g]),1);return m(x),"Integration Deleted Successfully"}return r.data});p.promise(b,{success:r=>r,error:o("Error Occurred","bit-integrations"),loading:o("delete...")})},[c]),P=u.useCallback(a=>{T(a)},[]),S=()=>{i.show=!1,j(N({},i))},z=(a,n)=>{i.action=()=>{H(a,n),S()},i.btnTxt=o("Delete","bit-integrations"),i.btn2Txt=null,i.btnClass="",i.body=o("Are you sure to delete this Integration?","bit-integrations"),i.show=!0,j(N({},i))},B=a=>{i.action=()=>{O(a),S()},i.btnTxt=o("Clone","bit-integration"),i.btn2Txt=null,i.btnClass="blue",i.body=o("Are you sure to clone this Integration ?","bitform"),i.show=!0,j(N({},i))},R={display:"flex",height:"82vh",justifyContent:"center",alignItems:"center"},L=a=>{!e||btcbi.pro==="undefined"?y({show:!0}):M({show:!0})};return l?t.jsx(Z,{style:R}):t.jsxs("div",{id:"all-forms",children:[t.jsx(et,{snack:w,setSnackbar:f}),t.jsx(st,{show:i.show,body:i.body,action:i.action,close:S,btnTxt:i.btnTxt,btn2Txt:i.btn2Txt,btn2Action:i.btn2Action,btnClass:i.btnClass}),c&&(c!=null&&c.length)?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"af-header flx flx-between",children:[t.jsx("h2",{children:o("Integrations","bit-integrations")}),c.length>=1&&!e?t.jsx("button",{className:"btn round btcd-btn-lg blue blue-sh",onClick:a=>L(),children:o("Create Integration","bit-integrations")}):t.jsx(C,{to:"/flow/new",className:"btn round btcd-btn-lg blue blue-sh",children:o("Create Integration","bit-integrations")})]}),t.jsx("div",{className:"forms",children:t.jsx(nt,{className:"f-table btcd-all-frm",height:500,columns:_,data:c,rowSeletable:!0,resizable:!0,columnHidable:!0,setTableCols:P,setBulkDelete:F,search:!0})}),t.jsx(ct,{md:!0,show:I.show,setModal:()=>y({show:!1}),title:o("Want to create unlimited integration ?","bit-integrations"),className:"pro-modal",data:c.length})]}):t.jsx(dt,{isLicenseActive:e,actionHandler:L,integrations:c}),t.jsxs(it,{sm:!0,show:v.show,setModal:()=>M({show:!1}),title:o("Please active your license","bit-integrations"),className:"pro-modal",children:[t.jsx("h4",{className:"txt-center mt-5",children:o("Please active your license to make unlimited integrations .","bit-integrations")}),t.jsx("div",{className:"txt-center",children:t.jsx("a",{href:window.btcbi.licenseURL,rel:"noreferrer",children:t.jsx("button",{className:"btn btn-lg blue",type:"button",children:o("Active license","bit-integrations")})})})]})]})}var ft=u.memo(ut);export{ft as default};
