var L=Object.defineProperty,J=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var I=(d,c,i)=>c in d?L(d,c,{enumerable:!0,configurable:!0,writable:!0,value:i}):d[c]=i,b=(d,c)=>{for(var i in c||(c={}))Q.call(c,i)&&I(d,i,c[i]);if(T)for(var i of T(c))X.call(c,i)&&I(d,i,c[i]);return d},C=(d,c)=>J(d,K(c));import{j as t,e as M,d as y,r as w,u as Y}from"./main-149.js";import{p as Z,$ as ee,h as te,m as k,i as ae,e as se,_ as l,k as ie,E as ne,n as le,q as oe,D as ce,L as A,F as re,d as _}from"./bi.738.82.js";import{T as de}from"./bi.21.729.js";import{T as R,t as me}from"./bi.452.742.js";/* empty css          */function h({options:d,placeholder:c,action:i,className:j,isMultiple:v,allowCustomOpt:n,value:N,addable:a,titleClassName:m,title:g,jsonValue:u}){return t.jsxs("div",{className:`${m}`,children:[t.jsx("span",{children:g}),t.jsx(Z,{width:"100%",defaultValue:N,className:`btcd-paper-drpdwn msl-wrp-options ${j}`,onChange:i,singleSelect:!v,customValue:n||a,placeholder:c,jsonValue:u,options:d||[]})]})}function je({allIntegURL:d,isInfo:c,edit:i,isLearnDash:j=!1,learnDashConf:v}){var S,$,E;const[n,N]=M(ee),[a,m]=M(te),{userMail:g}=y(k),u=y(ae),[B,D]=w.useState(!1),W=Y(),[P,x]=w.useState({show:!1}),{mailLinks:r}=me,V=y(k),{isPro:F}=V,f=()=>{const e=[];if(H()){const s=[];u.map(o=>{o.type==="email"&&s.push({label:o.label,value:`\${${o.name}}`})}),e.push({title:"Form Fields",type:"group",childs:s})}return g&&Array.isArray(g)&&e.push({title:"WP Emails",type:"group",childs:g}),e};w.useEffect(()=>{if(n!=null&&n.flow_details||i){const e=b({},n==null?void 0:n.flow_details);m(e)}else{const e=b({},a);a&&!(a!=null&&a.type)&&(e.type=j?"LearnDash":"Mail"),a&&!(a!=null&&a.condition)&&(e.name=j?"Send Email Leader":"Mail Integrations",e.condition={action_behavior:"",actions:[{field:"",action:"value"}],logics:[{field:"",logic:"",val:""},"or",{field:"",logic:"",val:""}]},m(e))}},[]);const z=(e,s)=>{const o=b({},a);s?o.condition.action_behavior=e:o.condition.action_behavior="",m(o)},p=(e,s)=>{const o=b({},a);e==="to"?o.to=s?s.split(","):[]:e==="cc"?o.cc=s?s.split(","):[]:e==="bcc"?o.bcc=s?s.split(","):[]:e==="replyto"?o.replyto=s?s.split(","):[]:e==="attachment"?o.attachment=s?s.split(","):[]:o[e]=s,m(o)},H=()=>{for(const e of u)if(e.type==="email")return!0;return!1},O=()=>{const e=[];for(const s of u)s.type==="file"&&e.push({label:s.label,value:s.name});return e},U=({target:{value:e}})=>{m(s=>C(b({},s),{subject:(s.subject!==void 0?s.subject:"")+e})),setTimeout(()=>{e=""},100)},q=()=>{if(!a.name){x({show:!0,msg:l("Integration Name cann't be empty","bit-integrations")});return}if(!a.to){x({show:!0,msg:l("Email Receiver cann't be empty","bit-integrations")});return}const e=C(b({},a),{learnDashConf:v});re(n,N,d,e,W,"",i,D).then(o=>{o.success?(i&&_.success("Integration Updated Successfully"),_.success("Integration Created Successfully")):_.error(o.data||o)})},G=e=>{m(s=>C(b({},s),{body:e}))};return t.jsxs("div",{children:[t.jsx(se,{snack:P,setSnackbar:x}),(r==null?void 0:r.youTubeLink)&&t.jsx(R,{title:r==null?void 0:r.title,youTubeLink:r==null?void 0:r.youTubeLink}),(r==null?void 0:r.docLink)&&t.jsx(R,{title:r==null?void 0:r.title,docLink:r==null?void 0:r.docLink}),t.jsx("span",{className:"f-m wdt-200 d-in-b",children:l("Integration Name","bit-integration")}),t.jsx("input",{className:"btcd-paper-inp w-5 mt-1",onChange:e=>p("name",e.target.value),name:"name",value:a.name,type:"text",placeholder:l("Integration Name...","bit-integrations"),disabled:c}),t.jsx("br",{}),t.jsx("br",{}),n.triggered_entity==="Webhook"&&(n==null?void 0:n.flow_details)&&t.jsx(ie,{setSnackbar:x}),n.triggered_entity!=="Webhook"&&(n==null?void 0:n.flow_details)&&t.jsx(ne,{setSnackbar:x}),t.jsx(h,{action:e=>p("from",e),placeholder:l("Add mail from address","bit-integrations"),value:a.from,title:t.jsx("span",{className:"f-m wdt-200 d-in-b",children:l("From","bit-integrations")}),titleClassName:"mt-2 flx",className:"w-5",addable:!0,options:f(a.from)}),t.jsx(h,{action:e=>p("to",e),value:a.to,placeholder:l("Add Email Receiver","bit-integrations"),title:t.jsx("span",{className:"f-m wdt-200 d-in-b",children:l("To","bit-integrations")}),isMultiple:!0,titleClassName:"mt-2 flx",className:"w-5",addable:!0,options:f(a.to)}),t.jsx(h,{action:e=>p("cc",e),value:a.cc,placeholder:l("Add Email CC","bit-integrations"),title:t.jsx("span",{className:"f-m wdt-200 d-in-b",children:l("CC","bit-integrations")}),isMultiple:!0,titleClassName:"mt-2 flx",className:"w-5",addable:!0,options:f(a.cc)}),t.jsx(h,{action:e=>p("bcc",e),placeholder:l("Add Email BCC","bit-integrations"),value:a.bcc,title:t.jsx("span",{className:"f-m wdt-200 d-in-b",children:l("BCC","bit-integrations")}),isMultiple:!0,titleClassName:"mt-2 flx",className:"w-5",addable:!0,options:f(a.bcc)}),t.jsx(h,{action:e=>p("replyto",e),placeholder:l("Reply To","bit-integrations"),value:a.replyto,title:t.jsx("span",{className:"f-m wdt-200 d-in-b",children:l("Reply To","bit-integrations")}),isMultiple:!0,titleClassName:"mt-2 flx",className:"w-5",addable:!0,options:f(a.replyto)}),t.jsx(h,{action:e=>p("attachment",e),placeholder:l("Attachment","bit-integrations"),value:(a==null?void 0:a.attachment)||[],title:t.jsx("span",{className:"f-m wdt-200 d-in-b",children:l("Attachment","bit-integrations")}),isMultiple:!0,disableChip:!1,customValue:!1,addable:!0,titleClassName:"mt-2 flx",className:"w-5",options:O()}),t.jsxs("div",{className:"mt-2 mb-4 flx",children:[t.jsx("span",{className:"f-m wdt-200 d-in-b",children:"Subject:"}),t.jsx("input",{onChange:e=>p("subject",e.target.value),name:"sub",type:"text",className:"btcd-paper-inp w-5",placeholder:"Email Subject Here",value:a.subject}),t.jsxs("select",{onChange:U,className:"btcd-paper-inp ml-2",style:{width:"20%"},children:[t.jsx("option",{value:"",children:l("Add field","bit-integrations")}),t.jsx("optgroup",{label:"Form Fields",children:u!==null&&u.map(e=>e.type!==void 0&&!e.type.match(/^(file|recaptcha)$/)&&t.jsx("option",{value:`\${${e.name}}`,children:e.label},e.name))}),t.jsx("optgroup",{label:`General Smart Codes ${F?"":"(PRO)"}`,children:F&&((S=le)==null?void 0:S.map(e=>t.jsx("option",{value:`\${${e.name}}`,children:e.label},`ff-rm-${e.name}`)))})]})]}),t.jsx(de,{id:"conf-mail",formFields:u,value:a.body,onChangeHandler:G,width:"100%"}),(a==null?void 0:a.condition)&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flx",children:t.jsx(oe,{onChange:e=>z(e.target.value,e.target.checked),checked:(($=a==null?void 0:a.condition)==null?void 0:$.action_behavior)==="cond",className:"wdt-200 mt-4 mr-2",value:"cond",title:l("Conditional Logics","bit_integration")})}),t.jsx("br",{}),((E=a==null?void 0:a.condition)==null?void 0:E.action_behavior)==="cond"&&t.jsx(ce,{formFields:u,dataConf:a,setDataConf:m})]}),t.jsx(ue,{saveConfig:q,isLoading:B,edit:(n==null?void 0:n.flow_details)&&!0})]})}const ue=({saveConfig:d,edit:c,isLoading:i})=>c?t.jsx("div",{className:"txt-center w-9 mt-3",children:t.jsxs("button",{onClick:d,className:"btn btcd-btn-lg green sh-sm flx",type:"button",disabled:i,children:[l("Update","bit-integrations"),i&&t.jsx(A,{size:20,clr:"#022217",className:"ml-2"})]})}):t.jsx("div",{className:"btcd-stp-page txt-center",style:{width:"100%",height:"auto"},children:t.jsxs("button",{onClick:d,className:"btn btcd-btn-lg green sh-sm",type:"button",disabled:i,children:[l("Save ","bit-integrations"),"âœ”",i&&t.jsx(A,{size:20,clr:"#022217",className:"ml-2"})]})});export{je as default};
